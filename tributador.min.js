angular.module("tributador.templates",[]).run(["$templateCache",function(e){e.put("base.html",'<div class="gumga-layout"><header class="gl-header" ng-controller="MenuController"><div class="searchbar"><div class="icon back"><button type="button" data-ng-click="toggleSearch()"><i class="material-icons">arrow_back</i></button></div><div class="query"><input type="text" class="form-control" placeholder="Pesquisar..."></div><div class="icon search"><button type="button"><i class="material-icons">search</i></button></div></div><nav class="navbar"><div class="container-fluid"><div class="navbar-header"><a class="navbar-brand" data-ng-click="navCollapse()"><i class="material-icons">menu</i></a><a class="navbar-brand" data-ng-click="navCollapse()">{{softwareName}}</a><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false"><i class="material-icons">more_vert</i></button><button type="button" class="navbar-toggle" data-ng-click="toggleSearch()"><i class="material-icons">search</i></button></div><div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1"><ul class="nav navbar-nav navbar-right"><li class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">{{user.name}}<span class="caret"></span></a><ul class="dropdown-menu"><li><a ui-sref="login.log">Sair</a></li></ul></li></ul></div></div></nav></header><main ui-view style="background-color: #f5f5f5"></main><nav class="gl-nav" ng-controller="MenuController"><div class="navbar-header"><a class="navbar-brand" data-ng-click="navCollapse()"><i class="material-icons">menu</i></a><a class="navbar-brand" data-ng-click="navCollapse()">{{softwareName}}</a></div><header><figure><img src="resources/images/gumga.png"></figure></header><gl-menu menu="menu" keys="keys"></gl-menu></nav></div>'),e.put("modules/taxsettings/views/form.html",'<form name="forms" novalidate gumga-form><div class="row"><div class="col-lg-12"><div class="ibox float-e-margins"><div class="ibox-content"><div class="row"><div class="col-md-12"><label gumga-translate-tag="taxsettings.titleparameterization">Title parameterization</label><input type="text" class="form-control" ng-model="entity.name"></div></div></div></div><div class="ibox float-e-margins"><div class="ibox-content"><div class="row"><div class="col-md-2 b-r" ng-click="openPanel(\'tribute\')"><h5 gumga-translate-tag="taxsettings.tributeupper" align="center" class="b cursor-pointer">TRIBUTE</h5><h5 class="cursor-pointer" ng-repeat="obj in tribute track by $index">- {{obj}}</h5></div><div class="col-md-2 b-r" ng-click="openPanel(\'operation\')"><h5 gumga-translate-tag="taxsettings.operation" align="center" class="b cursor-pointer">OPERATION</h5><div class="list-5-scroll"><h5 ng-repeat="ot in entity.operationTypes track by $index" class="text-muted cursor-pointer">- {{ot.name}}</h5></div></div><div class="col-md-2 b-r" ng-click="openPanel(\'origin\')"><h5 gumga-translate-tag="taxsettings.origin" align="center" class="b cursor-pointer">ORIGIN</h5><div class="list-5-scroll"><h5 ng-repeat="or in entity.origins track by $index" class="text-muted cursor-pointer">- {{or.label}}</h5></div></div><div class="col-md-2 b-r" ng-click="openPanel(\'destination\')"><h5 gumga-translate-tag="taxsettings.destination" align="center" class="b cursor-pointer">DESTINATION</h5><div class="list-5-scroll"><h5 ng-repeat="des in entity.destinations track by $index" class="text-muted cursor-pointer">- {{des.label}}</h5></div></div><div class="col-md-2 b-r" ng-click="openPanel(\'person\')"><h5 gumga-translate-tag="taxsettings.person" align="center" class="b cursor-pointer">PERSON</h5><div class="list-5-scroll"><h5 ng-repeat="pg in entity.personGroups track by $index" class="text-muted cursor-pointer">- {{pg.name}}</h5></div></div><div class="col-md-2" ng-click="openPanel(\'product\')"><h5 gumga-translate-tag="taxsettings.product" align="center" class="b cursor-pointer">PRODUCT</h5><div class="list-5-scroll"><h5 ng-repeat="pg in entity.productGroups track by $index" class="text-muted cursor-pointer">- {{pg.name}}</h5></div></div></div></div></div><div class="ibox float-e-margins" ng-show="configOpen"><div class="ibox-content"><div class="row"><div ng-hide="step2"><div class="col-md-4 col-md-offset-1" align="center"><h4 gumga-translate-tag="taxsettings.operation" class="b">OPERATION</h4><div style="max-height: 282px; overflow-y: auto"><gumga-list data="operationTypesList" configuration="confOperation" class="table-bordered" selected-values="entity.operationTypes"></gumga-list></div></div><div class="col-md-4 col-md-offset-1" align="center"><h4 gumga-translate-tag="taxsettings.origin" class="b">ORIGIN</h4><div style="max-height: 282px; overflow-y: auto"><gumga-list data="stateOriginList" configuration="confState" class="table-bordered" selected-values="entity.origins"></gumga-list></div></div><div class="col-md-1 col-md-offset-1"><button type="button" class="btn-link center-block fa fa-chevron-right fa-3x" uib-tooltip="Próximo" style="margin-top: 140px" ng-click="step2 = true"></button></div></div><div ng-show="step2"><div class="col-md-1"><button type="button" class="btn-link center-block fa fa-chevron-left fa-3x" uib-tooltip="Anterior" style="margin-top: 140px" ng-click="step2 = false"></button></div><div class="col-md-3" align="center"><h4 gumga-translate-tag="taxsettings.destination" class="b">DESTINATION</h4><div style="max-height: 282px; overflow-y: auto"><gumga-list data="stateDestinationList" configuration="confState" class="table-bordered" selected-values="entity.destinations"></gumga-list></div></div><div class="col-md-3" align="center"><h4 gumga-translate-tag="taxsettings.person" class="b">PERSON</h4><div style="max-height: 282px; overflow-y: auto"><gumga-list data="personGroupList" configuration="confPerson" class="table-bordered" selected-values="entity.personGroups"></gumga-list></div></div><div class="col-md-4" align="center"><h4 gumga-translate-tag="taxsettings.product" class="b">PRODUCT</h4><div style="max-height: 282px; overflow-y: auto"><gumga-list data="productGroupList" configuration="confProduct" class="table-bordered" selected-values="entity.productGroups"></gumga-list></div></div><div class="col-md-1"><button type="button" class="btn btn-primary btn-circle btn-lg form-control" uib-tooltip="Tributar" style="margin-top: 140px" ng-click="openTaxation = true; configOpen = false;" ng-disabled="blockBtnTributos(entity)"><i class="fa fa-calculator fa-lg" style="margin-left: -3px"></i></button></div></div></div></div></div><div ng-if="openTaxation"><div class="ibox float-e-margins"><div align="center" class="ibox-title"><label class="btn-link ibox-title-label" ng-click="showICMS = !showICMS"><i ng-class="{\'fa fa-caret-down\' :showICMS, \'fa fa-caret-right\':!showICMS}"></i><span>PARÂMETROS DA TRIBUTAÇÃO DO ICMS</span></label></div><div class="ibox-content" ng-show="showICMS"><div class="row container-fluid"><div class="row m-t"><div class="col-md-4"><label>CFOP</label><gumga-many-to-one value="icms.cfop" search-method="getCfopIcms(param)" field="descricao" async display-info="false"><match><div>{{match.model.codigo}}</div><div>{{match.model.descricao}}</div></match></gumga-many-to-one></div><div class="col-md-4" ng-show="icmsNormal"><label>CST</label><select name="icmsCst" id="icmsCst" ng-model="icms.CST" ng-options="cst.key as cst.label for cst in icmsTypes" class="form-control"></select></div><div class="col-md-4" ng-hide="icmsNormal"><label>CSOSN</label><select name="CSOSN" id="CSOSN" ng-model="icms.CSOSN" ng-options="cst.key as cst.label for cst in csosnTypes" class="form-control"></select></div><div class="col-md-4"><label>Mensagem</label><gumga-many-to-one value="icms.mensagem" search-method="getMensagem(param,\'ICMS\')" field="name" async display-info="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div><div class="row m-t" ng-show="icmsNormal"><div class="col-md-6"><div ng-hide="isIcmsAble(icms)"><div class="row" align="center"><h4 class="b">ICMS</h4></div><div ng-show="isIcmsStandartGroupAble(icms)"><div class="row"><div class="col-md-7"><label>Modalidade Deter. da BC ICMS</label><select name="icmsModBC" id="icmsModBC" ng-model="icms.modBC" class="form-control" ng-options="mod.key as mod.label for mod in modeCalculationBaseList"></select></div><div class="col-md-5"><label>Fórmula Valor da BC ICMS</label><gumga-many-to-one value="icms.vBC" search-method="getFormulaIcms(param)" field="name" async display-info="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div><div class="row m-t"><div class="col-md-5"><label>Alíquota ICMS</label><input type="text" class="form-control" ui-percentage-mask ng-model="icms.pICMS"></div><div class="col-md-7"><label>Fórmula Valor ICMS</label><gumga-many-to-one value="icms.vICMS" search-method="getFormulaIcms(param)" field="name" async display-info="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div></div><div class="row" ng-show="isRedGroupAble(icms)"><div class="col-md-5 m-t container-fluid"><label>Redução da BC ICMS</label><input type="text" class="form-control" ng-model="icms.pRedBC" ui-percentage-mask></div><div class="col-md-7 m-t" ng-hide="!(icms.CST == \'COBRANCA_ST_10_COM_PARTILHA\' || icms.CST == \'OUTRAS_COM_PARTILHA_90\')"><label>BC da operação própria</label><input type="text" class="form-control" ng-model="icms.pBCOp" ui-percentage-mask></div></div><div ng-show="isIcmsDesoGroupAble(icms)"><div class="row"><div class="col-md-7 m-t"><label>Valor ICMS Desonerado</label><gumga-many-to-one value="icms.vICMSDeson" search-method="getFormulaIcms(param)" field="name" async display-info="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div><div class="col-md-12 m-t"><div class="row"><label>Motivo da desoneração</label><select name="icmsMotDes" id="icmsMotDes" ng-model="icms.motDesICMS" class="form-control" ng-options="obj.key as obj.label for obj in unburdeningMotiveList"></select></div></div></div><div ng-show="icms.CST == \'DIFERIMENTO_51\'"><div class="row m-t"><div class="col-md-7"><label>ICMS da Operação</label><gumga-many-to-one value="icms.vICMSOp" search-method="getFormulaIcms(param)" field="name" async display-info="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div><div class="col-md-5"><label>Percentual do Diferimento</label><input type="text" class="form-control" ui-percentage-mask ng-model="icms.pDif"></div></div><div class="row m-t"><div class="col-md-7"><label>Valor do ICMS diferido</label><gumga-many-to-one value="icms.vICMSDif" search-method="getFormulaIcms(param)" field="name" async display-info="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div></div><div class="row m-t" ng-show="isFCPVisible(icms)"><div class="col-md-6"><label>Alíquota interna da UF de destino</label><input type="text" class="form-control" ui-percentage-mask ng-model="icms.pICMSUFDest"></div><div class="col-md-6"><label>Perc. Fundo Comb. à Pobreza</label><input type="text" class="form-control" ui-percentage-mask ng-model="icms.pFCPUFDest"></div></div></div></div><div class="col-md-6" ng-hide="isIcmsStAble(icms)"><div class="row" align="center"><h4 class="b">ICMS ST</h4></div><div ng-hide="isIcmsStStandartGroupAble(icms)"><div class="row"><div class="col-md-7"><label>Modalidade Deter. da BC ICMS ST</label><select name="icmsmodBCST" id="icmsBCST" ng-model="icms.modBCST" class="form-control" ng-options="modst.key as modst.label for modst in modeCalculationBaseSTList"></select></div><div class="col-md-5" ng-show="icms.CST == \'COBRANCA_ST_10\' || icms.CST == \'COBRANCA_ST_10_COM_PARTILHA\' || icms.CST == \'ISENTA_COM_ST_30\' || icms.CST == \'ST_REDUCAO_BC_70\' || icms.CST == \'OUTRAS_COM_PARTILHA_90\' || icms.CST == \'OUTROS_90\'"><label>Redução BC ICMS ST</label><input type="text" class="form-control" ui-percentage-mask ng-model="icms.pRedBCST"></div></div><div class="row m-t"><div class="col-md-5" ng-show="icms.CST == \'COBRANCA_ST_10\' || icms.CST == \'COBRANCA_ST_10_COM_PARTILHA\' || icms.CST == \'ISENTA_COM_ST_30\' || icms.CST == \'ST_REDUCAO_BC_70\' || icms.CST == \'OUTRAS_COM_PARTILHA_90\' || icms.CST == \'OUTROS_90\'"><label>Margem valor adic. ICMS ST</label><input type="text" class="form-control" ui-percentage-mask ng-model="icms.pMVAST"></div><div class="col-md-7" ng-show="icms.CST == \'COBRANCA_ST_10\' || icms.CST == \'COBRANCA_ST_10_COM_PARTILHA\' || icms.CST == \'ISENTA_COM_ST_30\' || icms.CST == \'ST_REDUCAO_BC_70\' || icms.CST == \'OUTRAS_COM_PARTILHA_90\' || icms.CST == \'OUTROS_90\'"><label>Fórmula Valor BC ICMS ST</label><gumga-many-to-one value="icms.vBCST" search-method="getFormulaIcms(param)" field="name" async display-info="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div><div class="row m-t"><div class="col-md-5" ng-show="icms.CST == \'COBRANCA_ST_10\' || icms.CST == \'COBRANCA_ST_10_COM_PARTILHA\' || icms.CST == \'ISENTA_COM_ST_30\' || icms.CST == \'ST_REDUCAO_BC_70\' || icms.CST == \'OUTRAS_COM_PARTILHA_90\' || icms.CST == \'OUTROS_90\'"><label>Alíquota ICMS ST</label><input type="text" class="form-control" ui-percentage-mask ng-model="icms.pICMSST"></div><div class="col-md-7" ng-show="icms.CST == \'COBRANCA_ST_10\' || icms.CST == \'COBRANCA_ST_10_COM_PARTILHA\' || icms.CST == \'ISENTA_COM_ST_30\' || icms.CST == \'ST_REDUCAO_BC_70\' || icms.CST == \'OUTRAS_COM_PARTILHA_90\' || icms.CST == \'OUTROS_90\'"><label>Fórmula Valor ICMS ST</label><gumga-many-to-one value="icms.vICMSST" search-method="getFormulaIcms(param)" field="name" async display-info="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div></div><div class="row m-t" ng-show="icms.CST == \'COBRANCA_ST_10_COM_PARTILHA\' || icms.CST == \'OUTRAS_COM_PARTILHA_90\'"><div class="col-md-6"><label>UF do ICMS ST devido na operação</label><select name="icmsuficmsdo" id="icmsuficmsdo" ng-model="icms.UFST" class="form-control" ng-options="obj.key as obj.label for obj in stateList"></select></div></div><div ng-show="icms.CST == \'ISENTA_COM_ST_30\'"><div class="row m-t"><div class="col-md-5"><label>Valor ICMS Desonerado</label><gumga-many-to-one value="icms.vICMSDeson" search-method="getFormulaIcms(param)" field="name" async display-info="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div><div class="col-md-12 m-t"><div class="row"><label>Motivo da desoneração</label><select name="modIcmsSetDeson" id="modIcmsSetDeson" ng-model="icms.motDesICMS" class="form-control" ng-options="obj.key as obj.label for obj in unburdeningMotiveList"></select></div></div></div><div class="row" ng-show="icms.CST == \'NAO_TRIBUTADA_41_ICMSST\' || icms.CST == \'COBRADO_ANTERIORMENTE_POR_ST_60\'"><div class="col-md-6"><label ng-hide="icms.CST == \'COBRADO_ANTERIORMENTE_POR_ST_60\'">BC ICMS ST retido na UF remet.</label><label ng-show="icms.CST == \'COBRADO_ANTERIORMENTE_POR_ST_60\'">BC ICMS ST retido anteriormente</label><gumga-many-to-one value="icms.vBCSTRet" search-method="getFormulaIcms(param)" field="name" async display-info="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div><div class="col-md-6"><label ng-hide="icms.CST == \'COBRADO_ANTERIORMENTE_POR_ST_60\'">ICMS ST retido na UF remet.</label><label ng-show="icms.CST == \'COBRADO_ANTERIORMENTE_POR_ST_60\'">ICMS ST retido anteriormente</label><gumga-many-to-one value="icms.vICMSSTRet" search-method="getFormulaIcms(param)" field="name" async display-info="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div><div class="row"><div class="col-md-5" ng-show="icms.CST == \'COBRADO_ANTERIORMENTE_POR_ST_60\' ||icms.CST == \'ST_REDUCAO_BC_70\' || icms.CST == \'OUTRAS_COM_PARTILHA_90\' || icms.CST == \'OUTROS_90\'"><label>Redução ICMS ST Próprio</label><input type="text" class="form-control" ui-percentage-mask ng-model="icms.pRedIMCSSTProp"></div></div><div class="row m-t" ng-show="icms.CST == \'NAO_TRIBUTADA_41_ICMSST\'"><div class="col-md-6"><label>BC ICMS ST da UF destino</label><gumga-many-to-one value="icms.vBCSTDest" search-method="getFormulaIcms(param)" field="name" async display-info="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div><div class="col-md-6"><label>ICMS ST da UF destino</label><gumga-many-to-one value="icms.vICMSSTDest" search-method="getFormulaIcms(param)" field="name" async display-info="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div></div></div><div class="row m-t" ng-hide="icmsNormal"><div class="col-md-6"><div ng-show="showSimples(icms)"><div class="row" align="center"><h4 class="b">ICMS</h4></div><div ng-show="icms.CSOSN === \'OUTROS_900\'" class="m-b"><div class="row"><div class="col-md-7"><label>Modalidade Deter. da BC ICMS</label><select name="icmsModBC" ng-model="icms.modBC" class="form-control" ng-options="mod.key as mod.label for mod in modeCalculationBaseList"></select></div><div class="col-md-5"><label>Fórmula Valor da BC ICMS</label><gumga-many-to-one value="icms.vBC" search-method="getFormulaIcms(param)" field="name" async display-info="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div><div class="row m-t"><div class="col-md-5"><label>Alíquota ICMS</label><input type="text" class="form-control" ui-percentage-mask ng-model="icms.pICMS"></div><div class="col-md-7"><label>Fórmula Valor ICMS</label><gumga-many-to-one value="icms.vICMS" search-method="getFormulaIcms(param)" field="name" async display-info="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div><div class="row"><div class="col-md-5 m-t container-fluid"><label>Redução da BC ICMS</label><input type="text" class="form-control" ng-model="icms.pRedBC" ui-percentage-mask></div></div></div><div class="row" ng-if="showAliquotaGroup(icms)"><div class="col-md-7"><label>Alíquota aplicável de cálculo do crédito</label><input type="text" class="form-control" ui-percentage-mask ng-model="icms.pCredSN"></div><div class="col-md-5"><label>Fórmula Vl. crédito do ICMS</label><gumga-many-to-one value="icms.vCredICMSSN" search-method="getFormulaIcms(param)" field="name" async display-info="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div><div class="row m-t" ng-show="isFCPVisible(icms)"><div class="col-md-6"><label>Alíquota interna da UF de destino</label><input type="text" class="form-control" ui-percentage-mask ng-model="icms.pICMSUFDest"></div><div class="col-md-6"><label>Perc. Fundo Comb. à Pobreza</label><input type="text" class="form-control" ui-percentage-mask ng-model="icms.pFCPUFDest"></div></div></div></div><div class="col-md-6" ng-show="showSimplesSt(icms)"><div class="row" align="center"><h4 class="b">ICMS ST</h4></div><div ng-show="showIcmsStSimple(icms)"><div class="row"><div class="col-md-7"><label>Modalidade Deter. da BC ICMS ST</label><select name="icmsmodBCST" ng-model="icms.modBCST" class="form-control" ng-options="modst.key as modst.label for modst in modeCalculationBaseSTList"></select></div><div class="col-md-5"><label>Redução BC ICMS ST</label><input type="text" class="form-control" ui-percentage-mask ng-model="icms.pRedBCST"></div></div><div class="row m-t"><div class="col-md-5" ng-if="icms.modBCST !== \'PAUTA\'"><label>Margem valor adic. ICMS ST</label><input type="text" class="form-control" ui-percentage-mask ng-model="icms.pMVAST"></div><div class="col-md-7 pull-right"><label>Fórmula Valor BC ICMS ST</label><gumga-many-to-one value="icms.vBCST" search-method="getFormulaIcms(param)" field="name" async display-info="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div><div class="row m-t"><div class="col-md-5"><label>Alíquota ICMS ST</label><input type="text" class="form-control" ui-percentage-mask ng-model="icms.pICMSST"></div><div class="col-md-7"><label>Fórmula Valor ICMS ST</label><gumga-many-to-one value="icms.vICMSST" search-method="getFormulaIcms(param)" field="name" async display-info="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div></div><div class="row" ng-show="icms.CSOSN === \'ANTECIPACAO_ST_500\'"><div class="col-md-6"><label>BC ICMS ST retido anteriormente</label><gumga-many-to-one value="icms.vBCSTRet" search-method="getFormulaIcms(param)" field="name" async display-info="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div><div class="col-md-6"><label>ICMS ST retido anteriormente</label><gumga-many-to-one value="icms.vICMSSTRet" search-method="getFormulaIcms(param)" field="name" async display-info="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div></div></div></div></div></div><div class="ibox float-e-margins"><div align="center" class="ibox-title"><label class="btn-link ibox-title-label" ng-click="showPIS = !showPIS"><i ng-class="{\'fa fa-caret-down\' :showPIS, \'fa fa-caret-right\':!showPIS}"></i><span>PARÂMETROS DA TRIBUTAÇÃO DO PIS</span></label></div><div class="ibox-content" ng-show="showPIS"><div class="row container-fluid"><div class="row"><div class="col-md-6"><label>CST</label><select name="cstpis" id="cstpis" ng-model="pis.CST" class="form-control" ng-options="obj.key as obj.label for obj in cstpis"></select></div><div class="col-md-6"><label>Mensagem</label><gumga-many-to-one value="pis.mensagem" search-method="getMensagem(param,\'PIS\')" field="name" async display-info="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div><div class="row m-t" ng-hide="isPisAble(pis)"><div class="col-md-6"><div ng-hide="pis.CST == \'OPERACAO_TRIBUTAVEL_05\'"><div class="row"><h4 class="b" align="center">PIS</h4></div><div class="row"><div class="col-md-6" ng-hide="isPisOperationTypeUnable(pis)"><label>Tipo de cálculo</label><select name="calculationpis" id="calculationpis" ng-model="pis.calculationType" class="form-control" ng-options="obj for obj in calculationTypes"></select></div><div class="row" ng-show="isPisAliquotaAble(pis)"><div class="col-md-12"><div class="row"><div class="col-md-12"><div class="col-md-6"><label>Valor da base de cálculo</label><gumga-many-to-one value="pis.vBC" search-method="getFormulaPis(param)" field="name" async display-info="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div><div class="col-md-6"><label>Alíquota (percentual)</label><input type="text" class="form-control" ui-percentage-mask ng-model="pis.pPIS"></div></div></div><div class="col-md-6 m-t"><label>Valor do PIS</label><gumga-many-to-one value="pis.vPIS" search-method="getFormulaPis(param)" field="name" async display-info="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div></div></div></div></div><div class="col-md-6" ng-show="pis.CST === \'OPERACAO_TRIBUTAVEL_05\'"><div class="row"><h4 class="b" align="center">PIS ST</h4></div><div class="row"><div class="col-md-6"><label>Tipo de cálculo</label><select name="calculationpisst" id="calculationpisst" ng-model="pis.calculationTypeST" class="form-control" ng-options="obj for obj in calculationTypes"></select></div></div><div class="row" ng-show=" pis.calculationTypeST == \'PORCENTAGEM\'"><div class="row"><div class="col-md-12"><div class="col-md-6 m-t"><label>Valor da base de cálculo</label><gumga-many-to-one value="pis.vBCST" search-method="getFormulaPis(param)" field="name" async display-info="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div><div class="col-md-6 m-t"><label>Alíquota (percentual)</label><input type="text" class="form-control" ui-percentage-mask ng-model="pis.pPISST"></div></div></div><div class="row"><div class="col-md-12"><div class="col-md-6 m-t"><label>Valor do PIS ST</label><gumga-many-to-one value="pis.vPISST" search-method="getFormulaPis(param)" field="name" async display-info="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div></div></div></div></div></div></div></div><div class="ibox float-e-margins"><div align="center" class="ibox-title"><label class="btn-link ibox-title-label" ng-click="showCOFINS = !showCOFINS"><i ng-class="{\'fa fa-caret-down\':showCOFINS, \'fa fa-caret-right\':!showCOFINS}"></i><span>PARÂMETROS DA TRIBUTAÇÃO DO COFINS</span></label></div><div class="ibox-content" ng-show="showCOFINS"><div class="row container-fluid"><div class="row"><div class="col-md-6"><label>CST</label><select name="cstcofins" id="cstcofins" ng-model="cofins.CST" class="form-control" ng-options="obj.key as obj.label for obj in cstpis"></select></div><div class="col-md-6"><label>Mensagem</label><gumga-many-to-one value="cofins.mensagem" search-method="getMensagem(param,\'COFINS\')" field="name" async display-info="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div><div class="row m-t" ng-hide="isCofinsAble(cofins)"><div class="col-md-6"><div ng-hide="cofins.CST == \'OPERACAO_TRIBUTAVEL_05\'"><div class="row"><h4 class="b" align="center">COFINS</h4></div><div class="row"><div class="col-md-6" ng-hide="isCofinsOperationTypeUnable(cofins)"><label>Tipo de cálculo</label><select name="calculationcofins" id="calculationcofins" ng-model="cofins.calculationType" class="form-control" ng-options="obj for obj in calculationTypes"></select></div><div class="row" ng-show="isCofinsAliquotaAble(cofins)"><div class="col-md-12"><div class="row"><div class="col-md-12"><div class="col-md-6 m-t"><label>Valor da base de cálculo</label><gumga-many-to-one value="cofins.vBC" search-method="getFormulaCofins(param)" field="name" async display-info="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div><div class="col-md-6 m-t"><label>Alíquota (percentual)</label><input type="text" class="form-control" ui-percentage-mask ng-model="cofins.pCOFINS"></div></div></div><div class="col-md-6 m-t"><label>Valor do COFINS</label><gumga-many-to-one value="cofins.vCOFINS" search-method="getFormulaCofins(param)" field="name" async display-info="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div></div></div></div></div><div class="col-md-6" ng-show="cofins.CST === \'OPERACAO_TRIBUTAVEL_05\'"><div class="row"><h4 class="b" align="center">COFINS ST</h4></div><div class="row"><div class="col-md-6"><label>Tipo de cálculo</label><select name="calculationcofinsst" id="calculationcofinsst" ng-model="cofins.calculationTypeST" class="form-control" ng-options="obj for obj in calculationTypes"></select></div></div><div ng-show="cofins.calculationTypeST == \'PORCENTAGEM\'"><div class="row"><div class="col-md-6 m-t"><label>Valor da base de cálculo</label><gumga-many-to-one value="cofins.vBCST" search-method="getFormulaCofins(param)" field="name" async display-info="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div><div class="col-md-4 m-t"><label>Alíquota (percentual)</label><input type="text" class="form-control" ui-percentage-mask ng-model="cofins.pCOFINSST"></div></div><div class="row"><div class="col-md-6 m-t"><label>Valor do COFINS ST</label><gumga-many-to-one value="cofins.vCOFINSST" search-method="getFormulaCofins(param)" field="name" async display-info="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div></div></div></div></div></div></div><div class="ibox float-e-margins"><div align="center" class="ibox-title"><label class="btn-link ibox-title-label" ng-click="showIPI = !showIPI"><i ng-class="{\'fa fa-caret-down\' :showIPI, \'fa fa-caret-right\':!showIPI }"></i><span>PARÂMETROS DA TRIBUTAÇÃO DO IPI</span></label></div><div class="ibox-content" ng-show="showIPI"><div class="row container-fluid"><div class="row"><div class="col-md-6"><label>CST</label><select name="cstipi" id="cstipi" ng-model="ipi.CST" class="form-control" ng-options="obj.key as obj.label for obj in cstipi"></select></div><div class="col-md-6"><label>Mensagem</label><gumga-many-to-one value="ipi.mensagem" search-method="getMensagem(param,\'IPI\')" field="name" async display-info="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div><div class="row"><div class="col-md-6"><div class="row m-t" ng-hide="isIpiAble(ipi)"><div class="col-md-6"><label>Tipo de cálculo</label><select name="calculationipi" id="calculationipi" ng-model="ipi.ipiCalculationType" class="form-control" ng-options="obj for obj in calculationTypes"></select></div><div ng-show="ipi.ipiCalculationType == \'PORCENTAGEM\'"><div class="row"><div class="col-md-12"><div class="col-md-6 m-t"><label>Valor da base de cálculo</label><gumga-many-to-one value="ipi.vBC" search-method="getFormulaIpi(param)" field="name" async display-info="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div><div class="col-md-6 m-t"><label>Alíquota</label><input type="text" class="form-control" ui-percentage-mask ng-model="ipi.pIPI"></div></div></div><div class="col-md-6 m-t"><label>Valor do IPI</label><gumga-many-to-one value="ipi.vIPI" search-method="getFormulaIpi(param)" field="name" async display-info="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div></div></div></div></div></div></div></div></div></div><div class="pull-right"><button type="button" grands-button="return" ui-sref="taxsettings.list" ng-show="entity.id"></button><button type="button" grands-button="cancel" ui-sref="taxsettings.list" ng-hide="entity.id"></button><button type="button" grands-button="save" ng-click="update(entity,icms,pis,cofins,ipi)" ng-disabled="blockBtnTributos(entity) || saveDisabled(entity,icms,pis,cofins,ipi)"></button></div></form>'),e.put("modules/taxsettings/views/list.html",'<div class="row"><div class="col-lg-12"><div class="ibox float-e-margins"><div class="ibox-content"><div class="col-md-12"><div class="row"><div class="row"><div class="col-md-5"><button type="button" ui-sref="taxsettings.insert" grands-button="new"></button><button type="button" ng-click="taxationGroup.methods.delete(selectedValues)" grands-button="delete" ng-disabled="selectedValues.length == 0"></button></div><div class="col-md-7"><gumga-query search="taxationGroup.methods.search(field, param)" advanced-search="taxationGroup.methods.advancedSearch(param)"><search-field field="name" label="{{\'titleparameterization\'|gumgaTranslate:\'taxsettings\'}}" select="true"></search-field><advanced-search-field type="string" label="{{\'titleparameterization\'|gumgaTranslate:\'taxsettings\'}}" field="name"></advanced-search-field></gumga-query></div></div></div></div><div class="row"><div class="col-md-12" style="margin-top:1%"><gumga-list data="taxationGroup.data" configuration="conf" class="table-bordered"></gumga-list></div><div class="col-md-12"><ul uib-pagination ng-model="taxationGroup.page" items-per-page="taxationGroup.pageSize" total-items="taxationGroup.count" ng-change="taxationGroup.methods.get(taxationGroup.page)" previous-text="<< Anterior" next-text="Próximo >>" first-text="«" last-text="»"></ul></div></div></div></div></div></div>'),e.put("modules/taxsettings/views/modalConflito.html",'<div class="modal-header"><h3 class="modal-title" gumga-translate-tag="taxsettings.modaltitle"></h3></div><div class="modal-body"><p gumga-translate-tag="taxsettings.modaltext"></p><gumga-list data="values" configuration="conf" class="table-bordered"></gumga-list></div><div class="modal-footer"><button class="btn btn-warning" type="button" ng-click="close()" grands-button="close"></button></div>')}]),angular.module("app.taxsettings.services",["api.location"]),angular.module("app.taxsettings.services").service("FormulaService",["GumgaRest","apiLocation",function(e,a){var t=new e(a+"/api/formula");return t}]),angular.module("app.taxsettings.services").service("MensagemService",["GumgaRest","apiLocation",function(e,a){
var t=new e(a+"/api/mensagem");return t.getAttributeMessageNames=function(){return this.extend("get","/attributemessagenames")},t}]),angular.module("app.taxsettings.services").service("TaxationGroupService",["GumgaRest","apiLocation",function(e,a){var t=new e(a+"/api/taxationgroup");return t.saveValiding=function(e){return e.id?this.extend("put","/validatesave",e):this.extend("post","/validatesave",e)},t.getStateList=function(){return this.extend("get","/state")},t.getICMSTypes=function(){return this.extend("get","/icmscst")},t.getCsosnTypes=function(){return this.extend("get","/csosntypes")},t.getIPITypes=function(){return this.extend("get","/ipicst")},t.getPISTypes=function(){return this.extend("get","/piscst")},t.getCalculationTypes=function(){return this.extend("get","/calculationtype")},t.getModeCalculationBaseTypes=function(){return this.extend("get","/modecalculationbase")},t.getModeCalculationBaseSTTypes=function(){return this.extend("get","/modecalculationbasest")},t.getUnburdeningMotives=function(){return this.extend("get","/unburdeningmotive")},t.getCofinsPisTypes=function(){return this.extend("get","/cofinscst")},t}]),angular.module("app.taxsettings.controllers",["app.taxsettings.services","ui.router"]),angular.module("app.taxsettings.controllers").controller("ModalConflitoController",["entity","values","$scope","$uibModalInstance",function(e,a,t,i){function s(e,a){return e.filter(function(e){return a.filter(function(a){return a.id===e.id}).length>0})}function o(e,a){return e.filter(function(e){return a.filter(function(a){return a.key===e.key}).length>0})}e=angular.copy(e),t.values=angular.copy(a),t.values=t.values.map(function(a){return a.operationTypes=s(a.operationTypes,e.operationTypes),a.productTypes=s(a.productGroups,e.productGroups),a.personTypes=s(a.personGroups,e.personGroups),a.destinations=o(a.destinations,e.destinations),a.origins=o(a.origins,e.origins),a}),t.conf={columns:"id,name,operations,origins,destinations,personTypes,productType",selection:"none",columnsConfig:[{name:"id",size:"col-md-1",title:'<strong gumga-translate-tag="taxsettings.id">Code</strong>',content:"<div>{{$value.id}}</div>"},{name:"name",size:"col-md-1",title:'<strong gumga-translate-tag="taxsettings.name">Tribute</strong>',content:"<div>{{$value.name}}</div>"},{name:"operations",size:"col-md-2",title:'<strong gumga-translate-tag="taxsettings.operations">Operations</strong>',content:"<span ng-repeat=\"obj in $value.operationTypes track by $index\"> {{!$first?', ':''}}{{obj.name}}</span>"},{name:"origins",size:"col-md-2",title:'<strong gumga-translate-tag="taxsettings.origins">Origins</strong>',content:"<span ng-repeat=\"obj in $value.origins track by $index\"> {{!$first?', ':''}}{{obj.label}}</span>"},{name:"destinations",size:"col-md-2",title:'<strong gumga-translate-tag="taxsettings.destinations">Destinations</strong>',content:"<span ng-repeat=\"obj in $value.destinations track by $index\"> {{!$first?', ':''}}{{obj.label}}</span>"},{name:"personTypes",size:"col-md-2",title:'<strong gumga-translate-tag="taxsettings.groupofpeople">Group of People</strong>',content:"<span ng-repeat=\"obj in $value.personTypes track by $index\"> {{!$first?', ':''}}{{obj.name}}</span>"},{name:"productType",size:"col-md-2",title:'<strong gumga-translate-tag="taxsettings.productgroup">Product Group</strong>',content:"<span ng-repeat=\"obj in $value.productTypes track by $index\"> {{!$first?', ':''}}{{obj.name}}</span>"}]},t.close=function(){i.close(t.values)}}]),angular.module("app.taxsettings.controllers").controller("TaxSettingsFormController",["TaxationGroupService","MensagemService","JuridicaService","OperationTypeService","PersonGroupService","ProductGroupService","CfopService","FormulaService","$state","entity","$scope","$timeout","$uibModal","$rootScope","gumgaController",function(e,a,t,i,s,o,n,l,c,r,d,m,u,S,C){function T(e){if(e.CST)switch(e.CST){case"OPERACAO_TRIBUTAVEL_01":case"OPERACAO_TRIBUTAVEL_02":if(P(e))return!0;break;case"OPERACAO_TRIBUTAVEL_05":if(!e.calculationTypeST)return!0;if("PORCENTAGEM"===e.calculationTypeST&&M(e))return!0;break;case"OUTRAS_SAIDAS_49":case"OPERACOES_CREDITO_50":case"OPERACOES_CREDITO_51":case"OPERACOES_CREDITO_52":case"OPERACOES_CREDITO_53":case"OPERACOES_CREDITO_54":case"OPERACOES_CREDITO_55":case"OPERACOES_CREDITO_56":case"CREDITO_PRESUMIDO_60":case"CREDITO_PRESUMIDO_61":case"CREDITO_PRESUMIDO_62":case"CREDITO_PRESUMIDO_63":case"CREDITO_PRESUMIDO_64":case"CREDITO_PRESUMIDO_65":case"CREDITO_PRESUMIDO_66":case"CREDITO_PRESUMIDO_67":case"AQUISICAO_SEM_CREDITO_70":case"AQUISICAO_ISENTA_71":case"AQUISICAO_COM_SUSPENSAO_72":case"AQUISICAO_ALIQUOTA_ZERO_73":case"AQUISICAO_SEM_CONTRIBUICAO_74":case"AQUISICAO_ST_75":case"OUTRAS_ENTRADAS_98":case"OUTRAS_99":if(!e.calculationType)return!0;if("PORCENTAGEM"===e.calculationType&&P(e))return!0}}function v(e){if(e.CST)switch(e.CST){case"OPERACAO_TRIBUTAVEL_01":case"OPERACAO_TRIBUTAVEL_02":if(E(e))return!0;break;case"OPERACAO_TRIBUTAVEL_05":if(!e.calculationTypeST)return!0;if("PORCENTAGEM"===e.calculationTypeST&&h(e))return!0;break;case"OUTRAS_SAIDAS_49":case"OPERACOES_CREDITO_50":case"OPERACOES_CREDITO_51":case"OPERACOES_CREDITO_52":case"OPERACOES_CREDITO_53":case"OPERACOES_CREDITO_54":case"OPERACOES_CREDITO_55":case"OPERACOES_CREDITO_56":case"CREDITO_PRESUMIDO_60":case"CREDITO_PRESUMIDO_61":case"CREDITO_PRESUMIDO_62":case"CREDITO_PRESUMIDO_63":case"CREDITO_PRESUMIDO_64":case"CREDITO_PRESUMIDO_65":case"CREDITO_PRESUMIDO_66":case"CREDITO_PRESUMIDO_67":case"AQUISICAO_SEM_CREDITO_70":case"AQUISICAO_ISENTA_71":case"AQUISICAO_COM_SUSPENSAO_72":case"AQUISICAO_ALIQUOTA_ZERO_73":case"AQUISICAO_SEM_CONTRIBUICAO_74":case"AQUISICAO_ST_75":case"OUTRAS_ENTRADAS_98":case"OUTRAS_99":if(!e.calculationType)return!0;if("PORCENTAGEM"===e.calculationType&&E(e))return!0}}function g(e){if(e.CST)switch(e.CST){case"ENTRADA_RECUPERACAO_CREDITO_00":case"OUTRAS_ENTRADAS_49":case"SAIDA_TRIBUTADA_50":case"OUTRAS_SAIDAS_99":if(!e.ipiCalculationType||"PORCENTAGEM"===e.ipiCalculationType&&y(e))return!0}}function p(e){if(e.CST)switch(e.CST){case"INTEGRALMENTE_00":if(D(e))return!0;break;case"COBRANCA_ST_10":if(D(e)||U(e))return!0;break;case"OUTRAS_COM_PARTILHA_90":case"COBRANCA_ST_10_COM_PARTILHA":if(D(e)||U(e)||!e.UFST)return!0;break;case"REDUCAO_BC_20":if(D(e)||N(e))return!0;break;case"ISENTA_COM_ST_30":if(U(e)||N(e))return!0;break;case"ISENTA_40":case"NAO_TRIBUTADA_41":case"SUSPENSAO_50":if(N(e))return!0;break;case"NAO_TRIBUTADA_41_ICMSST":if(B(e))return!0;break;case"DIFERIMENTO_51":if(D(e)||x(e))return!0;break;case"COBRADO_ANTERIORMENTE_POR_ST_60":if(w(e))return!0;break;case"ST_REDUCAO_BC_70":case"OUTROS_90":if(D(e)||N(e)||U(e))return!0}}function I(e){if(e.CSOSN)switch(e.CSOSN){case"CREDITO_101":if(A(e))return!0;break;case"CREDITO_COM_ST_201":if(O(e)||A(e))return!0;break;case"SEM_CREDITO_COM_ST_202":case"RECEITA_BRUTA_COM_ST_203":if(O(e))return!0;break;case"ANTECIPACAO_ST_500":if(_(e))return!0;break;case"OUTROS_900":if(O(e)||A(e)||D(e))return!0}}function _(e){return e.vBCSTRet&&!e.vICMSSTRet||!e.vBCSTRet&&e.vICMSSTRet}function O(e){return!e.modBCST||!e.vBCST||null==e.pICMSST||!e.vICMSST}function A(e){return null==e.pCredSN||null==e.vCredICMSSN}function f(){c.go("taxsettings.list")}function b(e){var a=e.data.map(function(e){return e.destinations=R(e.destinations,d.stateDestinationList),e.origins=R(e.origins,d.stateOriginList),e});u.open({size:"lg",templateUrl:"modules/taxsettings/views/modalConflito.html",controller:"ModalConflitoController",resolve:{values:function(){return a},entity:function(){return d.entity}}})}function R(e,a){return e=e||[],e.map(function(e){return a.filter(function(a){return a.key===e})[0]})}function h(e){return!e.vBCST||null==e.pCOFINSST||!e.vCOFINSST}function E(e){return!e.vBC||null==e.pCOFINS||!e.vCOFINS}function y(e){return!e.vBC||null==e.pIPI||!e.vIPI}function M(e){return!e.vBCST||null==e.pPISST||!e.vPISST}function P(e){return!e.vBC||null==e.pPIS||!e.vPIS}function D(e){return!e.modBC||!e.vBC||null==e.pICMS||!e.vICMS}function N(e){return e.vICMSDeson&&!e.motDesICMS||!e.vICMSDeson&&e.motDesICMS}function U(e){return!(e.modBCST&&e.pRedBCST&&null!=e.pMVAST&&e.vBCST&&null!=e.pICMSST&&e.vICMSST)}function B(e){return!(e.vBCSTRet&&e.vICMSSTRet&&e.vBCSTDest&&e.vICMSSTDest)}function x(e){return!e.vICMSOp||null==e.pDif||!e.vICMSDif}function w(e){return!e.vBCSTRet||!e.vICMSSTRet}function F(e){return e.key}function k(e){var a={CST:e.CST,version:e.version,cfop:e.cfop,mensagem:e.mensagem};return"INTEGRALMENTE_00"!==e.CST&&"COBRANCA_ST_10"!==e.CST&&"OUTRAS_COM_PARTILHA_90"!==e.CST&&"COBRANCA_ST_10_COM_PARTILHA"!==e.CST&&"REDUCAO_BC_20"!==e.CST&&"DIFERIMENTO_51"!==e.CST&&"ST_REDUCAO_BC_70"!==e.CST&&"OUTROS_90"!==e.CST||(a.modBC=e.modBC,a.pICMS=e.pICMS,a.vBC=e.vBC,a.vICMS=e.vICMS),"COBRANCA_ST_10"!==e.CST&&"OUTRAS_COM_PARTILHA_90"!==e.CST&&"COBRANCA_ST_10_COM_PARTILHA"!==e.CST&&"ISENTA_COM_ST_30"!==e.CST&&"ST_REDUCAO_BC_70"!==e.CST&&"OUTROS_90"!==e.CST||(a.modBCST=e.modBCST,a.pICMSST=e.pICMSST,a.pMVAST=e.pMVAST,a.pRedBCST=e.pRedBCST,a.vBCST=e.vBCST,a.vICMSST=e.vICMSST),"OUTRAS_COM_PARTILHA_90"!==e.CST&&"COBRANCA_ST_10_COM_PARTILHA"!==e.CST||(a.UFST=e.UFST),"REDUCAO_BC_20"!==e.CST&&"ISENTA_COM_ST_30"!==e.CST&&"ISENTA_40"!==e.CST&&"NAO_TRIBUTADA_41"!==e.CST&&"SUSPENSAO_50"!==e.CST&&"ST_REDUCAO_BC_70"!==e.CST&&"OUTROS_90"!==e.CST||(a.vICMSDeson=e.vICMSDeson,a.motDesICMS=e.motDesICMS),"NAO_TRIBUTADA_41_ICMSST"===e.cst&&(a.vBCSTRet=e.vBCSTRet,a.vBCSTDest=e.vBCSTDest,a.vICMSSTDest=e.vICMSSTDest,a.vICMSSTRet=e.vICMSSTRet),"DIFERIMENTO_51"===e.cst&&(a.pDif=e.pDif,a.vICMSDif=e.vICMSDif,a.vICMSOp=e.vICMSOp),"COBRADO_ANTERIORMENTE_POR_ST_60"===e.cst&&(a.vBCSTRet=e.vBCSTRet,a.vICMSSTRet=e.vICMSSTRet),a}function L(e){var a={version:e.version,cfop:e.cfop,mensagem:e.mensagem,CSOSN:e.CSOSN};return"CREDITO_101"!==e.CSOSN&&"CREDITO_COM_ST_201"!==e.CSOSN&&"OUTROS_900"!==e.CSOSN||(a.pCredSN=e.pCredSN,a.vCredICMSSN=e.vCredICMSSN),"CREDITO_COM_ST_201"!==e.CSOSN&&"SEM_CREDITO_COM_ST_202"!==e.CSOSN&&"RECEITA_BRUTA_COM_ST_203"!==e.CSOSN&&"OUTROS_900"!==e.CSOSN||(a.modBCST=e.modBCST,a.pICMSST=e.pICMSST,a.pMVAST=e.pMVAST,a.pRedBCST=e.pRedBCST,a.vBCST=e.vBCST,a.vICMSST=e.vICMSST),"ANTECIPACAO_ST_500"===e.CSOSN&&(a.vBCSTRet=e.vBCSTRet,a.vICMSSTRet=e.vICMSSTRet),"OUTROS_900"===e.CSOSN&&(a.modBC=e.modBC,a.vBC=e.vBC,a.pRedBC=e.pRedBC,a.pICMS=e.pICMS,a.vICMS=e.vICMS),a}function G(e){var a={CST:e.CST,version:e.version,mensagem:e.mensagem};switch(e.CST){case"OPERACAO_TRIBUTAVEL_05":a.calculationTypeST=e.calculationTypeST,"PORCENTAGEM"===e.calculationTypeST&&(a.pPISST=e.pPISST,a.vBCST=e.vBCST,a.vPISST=e.vPISST);break;case"OPERACAO_TRIBUTAVEL_01":case"OPERACAO_TRIBUTAVEL_02":a.pPIS=e.pPIS,a.vBC=e.vBC,a.vPIS=e.vPIS;break;case"OUTRAS_SAIDAS_49":case"OPERACOES_CREDITO_50":case"OPERACOES_CREDITO_51":case"OPERACOES_CREDITO_52":case"OPERACOES_CREDITO_53":case"OPERACOES_CREDITO_54":case"OPERACOES_CREDITO_55":case"OPERACOES_CREDITO_56":case"CREDITO_PRESUMIDO_60":case"CREDITO_PRESUMIDO_61":case"CREDITO_PRESUMIDO_62":case"CREDITO_PRESUMIDO_63":case"CREDITO_PRESUMIDO_64":case"CREDITO_PRESUMIDO_65":case"CREDITO_PRESUMIDO_66":case"CREDITO_PRESUMIDO_67":case"AQUISICAO_SEM_CREDITO_70":case"AQUISICAO_ISENTA_71":case"AQUISICAO_COM_SUSPENSAO_72":case"AQUISICAO_ALIQUOTA_ZERO_73":case"AQUISICAO_SEM_CONTRIBUICAO_74":case"AQUISICAO_ST_75":case"OUTRAS_ENTRADAS_98":case"OUTRAS_99":a.calculationType=e.calculationType,"PORCENTAGEM"===e.calculationType&&(a.pPIS=e.pPIS,a.vBC=e.vBC,a.vPIS=e.vPIS)}return a}function V(e){var a={CST:e.CST,version:e.version,mensagem:e.mensagem};switch(e.CST){case"OPERACAO_TRIBUTAVEL_05":a.calculationTypeST=e.calculationTypeST,"PORCENTAGEM"===e.calculationTypeST&&(a.pCOFINSST=e.pCOFINSST,a.vBCST=e.vBCST,a.vCOFINSST=e.vCOFINSST);break;case"OPERACAO_TRIBUTAVEL_01":case"OPERACAO_TRIBUTAVEL_02":a.pCOFINS=e.pCOFINS,a.vBC=e.vBC,a.vCOFINS=e.vCOFINS;break;case"OUTRAS_SAIDAS_49":case"OPERACOES_CREDITO_50":case"OPERACOES_CREDITO_51":case"OPERACOES_CREDITO_52":case"OPERACOES_CREDITO_53":case"OPERACOES_CREDITO_54":case"OPERACOES_CREDITO_55":case"OPERACOES_CREDITO_56":case"CREDITO_PRESUMIDO_60":case"CREDITO_PRESUMIDO_61":case"CREDITO_PRESUMIDO_62":case"CREDITO_PRESUMIDO_63":case"CREDITO_PRESUMIDO_64":case"CREDITO_PRESUMIDO_65":case"CREDITO_PRESUMIDO_66":case"CREDITO_PRESUMIDO_67":case"AQUISICAO_SEM_CREDITO_70":case"AQUISICAO_ISENTA_71":case"AQUISICAO_COM_SUSPENSAO_72":case"AQUISICAO_ALIQUOTA_ZERO_73":case"AQUISICAO_SEM_CONTRIBUICAO_74":case"AQUISICAO_ST_75":case"OUTRAS_ENTRADAS_98":case"OUTRAS_99":a.calculationType=e.calculationType,"PORCENTAGEM"===e.calculationType&&(a.pCOFINS=e.pCOFINS,a.vBC=e.vBC,a.vCOFINS=e.vCOFINS)}return a}function j(e){var a={CST:e.CST,version:e.version,mensagem:e.mensagem};switch(e.CST){case"ENTRADA_RECUPERACAO_CREDITO_00":case"OUTRAS_ENTRADAS_49":case"SAIDA_TRIBUTADA_50":case"OUTRAS_SAIDAS_99":a.ipiCalculationType=e.ipiCalculationType,"PORCENTAGEM"===e.ipiCalculationType&&(a.pIPI=e.pIPI,a.vBC=e.vBC,a.vIPI=e.vIPI)}return a}function $(e){return{"2px solid red":function(){return d.operationConflicts.filter(function(a){return a.id===e.id}).length>0}}}C.createRestMethods(d,e,"taxationGroup"),d.taxationGroup.execute("reset"),d.entity=angular.copy(r.data),d.pis=d.entity.taxationPIS||{},d.icms=d.entity.taxationICMS||{},d.cofins=d.entity.taxationCOFINS||{},d.ipi=d.entity.taxationIPI||{},d.continue={},d.entity.operationTypes=d.entity.operationTypes||[],d.entity.origins=d.entity.origins||[],d.entity.destinations=d.entity.destinations||[],d.entity.personGroups=d.entity.personGroups||[],d.entity.productGroups=d.entity.productGroups||[],d.vICMSd=d.vICMSd||0,d.showICMS=!1,d.showPIS=!1,d.showCOFINS=!1,d.openTaxation=!1,d.step1=!1,d.configOpen=!1,d.mensagemICMSList=[],d.mensagemPISList=[],d.mensagemIPIList=[],d.mensagemCOFINSList=[],d.formulaIcmsBCList=[],d.formulaValorIcms=[],d.formulaBaseIcmsSt=[],d.formulaValorIcmsSt=[],d.formulaValorIcmsDeson=[],d.formulaIcmsStDeson=[],d.fomulasBaseIcmsRet=[],d.formulaValorIcmsRet=[],d.formulaBaseIcmsDest=[],d.formulaValorIcmsDest=[],d.formulaValorIcmsOpe=[],d.formulaBasePis=[],d.formulaBasePisST=[],d.formulaValorPisST=[],d.formulaValorPis=[],d.formulaBaseCofins=[],d.formulaBaseCofinsST=[],d.formulaValorCofinsST=[],d.formulaValorCofins=[],d.cfopList=[],d.stateOriginConflicts=[],d.stateDestinationsConflicts=[],d.personGroupConflicts=[],d.productGroupConflicts=[],d.operationConflicts=[],d.entity.id&&(d.openTaxation=!0,d.configOpen=!1),t.getCurrentCompany().then(function(e){d.icmsNormal="REGIME_NORMAL"===e.data.crt,d.icmsNormal?d.tribute=["ICMS","PIS","COFINS","IPI"]:(d.tribute=["ICMS Simples","PIS","COFINS","IPI"],d.icms.CST="")}),i.all().then(function(e){d.operationTypesList=e.data.values,m(function(){d.entity.operationTypes=r.data.operationTypes||[],d.entity.operationTypes=d.entity.operationTypes.map(function(e){return d.operationTypesList.filter(function(a){return a.id===e.id})[0]})})}),s.all().then(function(e){d.personGroupList=e.data.values,m(function(){d.entity.personGroups=r.data.personGroups||[]})}),o.all().then(function(e){d.productGroupList=e.data.values,m(function(){d.entity.productGroups=r.data.productGroups||[]})}),e.getStateList().then(function(e){d.stateDestinationList=d.stateOriginList=e.data,m(function(){d.entity.origins=R(r.data.origins,d.stateOriginList),d.entity.destinations=R(r.data.destinations,d.stateDestinationList)})}),e.getICMSTypes().then(function(e){d.icmsTypes=[{label:" "}].concat(e.data)}),e.getCsosnTypes().then(function(e){d.csosnTypes=[{label:" "}].concat(e.data)}),e.getPISTypes().then(function(e){d.cstpis=[{label:" "}].concat(e.data)}),e.getIPITypes().then(function(e){d.cstipi=[{label:" "}].concat(e.data)}),e.getCalculationTypes().then(function(e){d.calculationTypes=e.data}),e.getModeCalculationBaseTypes().then(function(e){d.modeCalculationBaseList=[{label:" "}].concat(e.data)}),e.getModeCalculationBaseSTTypes().then(function(e){d.modeCalculationBaseSTList=[{label:" "}].concat(e.data)}),e.getUnburdeningMotives().then(function(e){d.unburdeningMotiveList=[{label:" "}].concat(e.data)}),d.confOperation={columns:"operations",selection:"multi",conditional:$,checkbox:!0,columnsConfig:[{name:"operations",size:"col-md-9",title:'<strong gumga-translate-tag="taxsettings.operations">Operations</strong>',content:"<div>{{$value.name}}</div>"}]},d.confState={columns:"state",selection:"multi",checkbox:!0,columnsConfig:[{name:"state",size:"col-md-9",title:'<strong gumga-translate-tag="taxsettings.state">State</strong>',content:"<div>{{$value.label}}</div>"}]},d.confPerson={columns:"person",selection:"multi",checkbox:!0,columnsConfig:[{name:"person",size:"col-md-9",title:'<strong gumga-translate-tag="taxsettings.groupofpeople">Group of People</strong>',content:"<div>{{$value.name}}</div>"}]},d.confProduct={columns:"product",selection:"multi",checkbox:!0,columnsConfig:[{name:"product",size:"col-md-9",title:'<strong gumga-translate-tag="taxsettings.productgroup">Product Group</strong>',content:"<div>{{$value.name}}</div>"}]},d.openPanel=function(e){"tribute"===e||"operation"===e||"origin"===e?(d.configOpen=!0,d.openTaxation=!1,d.step2=!1):(d.configOpen=!0,d.openTaxation=!1,d.step2=!0)},d.entity.id||d.openPanel("tribute"),d.blockBtnTributos=function(e){return 0===e.operationTypes.length||0===e.origins.length||0===e.destinations.length||0===e.personGroups.length||0===e.productGroups.length},d.isIcmsAble=function(e){return!e.CST||"ISENTA_COM_ST_30"===e.CST||"NAO_TRIBUTADA_41_ICMSST"===e.CST||"COBRADO_ANTERIORMENTE_POR_ST_60"===e.CST},d.isIcmsStandartGroupAble=function(e){return"INTEGRALMENTE_00"===e.CST||"COBRANCA_ST_10"===e.CST||"COBRANCA_ST_10_COM_PARTILHA"===e.CST||"REDUCAO_BC_20"===e.CST||"DIFERIMENTO_51"===e.CST||"ST_REDUCAO_BC_70"===e.CST||"OUTRAS_COM_PARTILHA_90"===e.CST||"OUTROS_90"===e.CST},d.isIcmsDesoGroupAble=function(e){return"REDUCAO_BC_20"===e.CST||"ISENTA_40"===e.CST||"NAO_TRIBUTADA_41"===e.CST||"SUSPENSAO_50"===e.CST||"ST_REDUCAO_BC_70"===e.CST||"OUTROS_90"===e.CST},d.isIcmsRedGroupAble=function(e){return"COBRANCA_ST_10_COM_PARTILHA"===e.CST||"REDUCAO_BC_20"===e.CST||"DIFERIMENTO_51"===e.CST||"ST_REDUCAO_BC_70"===e.CST||"OUTRAS_COM_PARTILHA_90"===e.CST||"OUTROS_90"===e.CST},d.isIcmsStAble=function(e){return!e.CST||"INTEGRALMENTE_00"===e.CST||"REDUCAO_BC_20"===e.CST||"ISENTA_40"===e.CST||"NAO_TRIBUTADA_41"===e.CST||"SUSPENSAO_50"===e.CST||"DIFERIMENTO_51"===e.CST},d.isIcmsStStandartGroupAble=function(e){return"NAO_TRIBUTADA_41_ICMSST"===e.CST||"COBRADO_ANTERIORMENTE_POR_ST_60"===e.CST},d.getCfopIcms=function(e){return e=e||"",n.getAdvancedSearch("lower(obj.codigo) like lower('%"+e+"%') or lower(obj.descricao) like lower('%"+e+"%')").then(function(e){return e.data.values})},d.getFormulaIcms=function(e){return l.getAdvancedSearch("lower(obj.name) like lower('%"+e+"%') and obj.tariffType = br.com.codein.tributador.domain.model.tributador.enums.TariffType.ICMS").then(function(e){return e.data.values})},d.getFormulaPis=function(e){return l.getAdvancedSearch("lower(obj.name) like lower('%"+e+"%') and obj.tariffType = br.com.codein.tributador.domain.model.tributador.enums.TariffType.PIS").then(function(e){return e.data.values})},d.getFormulaCofins=function(e){return l.getAdvancedSearch("lower(obj.name) like lower('%"+e+"%') and obj.tariffType = br.com.codein.tributador.domain.model.tributador.enums.TariffType.COFINS").then(function(e){return e.data.values})},d.getFormulaIpi=function(e){return l.getAdvancedSearch("lower(obj.name) like lower('%"+e+"%') and obj.tariffType = br.com.codein.tributador.domain.model.tributador.enums.TariffType.IPI").then(function(e){return e.data.values})},d.getMensagem=function(e,t){return a.getAdvancedSearch("lower(obj.name) like lower('%"+e+"%') and obj.tariffType = br.com.codein.tributador.domain.model.tributador.enums.TariffType."+t).then(function(e){return e.data.values})},d.isIpiAble=function(e){return!e.CST||"ENTRADA_RECUPERACAO_CREDITO_00"!==e.CST&&"OUTRAS_ENTRADAS_49"!==e.CST&&"SAIDA_TRIBUTADA_50"!==e.CST&&"OUTRAS_SAIDAS_99"!==e.CST},d.isPisAble=function(e){return!e.CST||"OPERACAO_TRIBUTAVEL_04"===e.CST||"OPERACAO_TRIBUTAVEL_03"===e.CST||"OPERACAO_TRIBUTAVEL_06"===e.CST||"OPERACAO_TRIBUTAVEL_07"===e.CST||"SEM_INCIDENCIA_08"===e.CST||"COM_SUSPENSAO_09"===e.CST},d.isPisOperationTypeUnable=function(e){return e.CST&&(d.isPisAble(e)||"OPERACAO_TRIBUTAVEL_01"===e.CST||"OPERACAO_TRIBUTAVEL_02"===e.CST)},d.isPisAliquotaAble=function(e){return d.isPisOperationTypeUnable(e)||"PORCENTAGEM"===e.calculationType},d.isCofinsAble=function(e){return!e.CST||"OPERACAO_TRIBUTAVEL_04"===e.CST||"OPERACAO_TRIBUTAVEL_03"===e.CST||"OPERACAO_TRIBUTAVEL_06"===e.CST||"OPERACAO_TRIBUTAVEL_07"===e.CST||"SEM_INCIDENCIA_08"===e.CST||"COM_SUSPENSAO_09"===e.CST},d.isCofinsOperationTypeUnable=function(e){return e.CST&&(d.isCofinsAble(e)||"OPERACAO_TRIBUTAVEL_01"===e.CST||"OPERACAO_TRIBUTAVEL_02"===e.CST)},d.isCofinsAliquotaAble=function(e){return d.isCofinsOperationTypeUnable(e)||"PORCENTAGEM"===e.calculationType},d.saveDisabled=function(e,a,t,i,s){return d.icmsNormal&&p(a)||!d.icmsNormal&&I(a)||T(t)||v(i)||g(s)},d.update=function(a,t,i,s,o){a.destinations=a.destinations.map(F),a.origins=a.origins.map(F),delete a.taxationIPI,delete a.taxationPIS,delete a.taxationCOFINS,delete a.taxationICMS,o=angular.copy(o),t=angular.copy(t),i=angular.copy(i),s=angular.copy(s),o.CST&&(a.taxationIPI=j(o)),d.icmsNormal&&t.CST?a.taxationICMS=k(t):!d.icmsNormal&&t.CSOSN&&(a.taxationICMS=L(t)),a.taxationICMS&&d.isFCPVisible(a.taxationICMS)&&(a.taxationICMS.pICMSUFDest=t.pICMSUFDest,a.taxationICMS.pFCPUFDest=t.pFCPUFDest),i.CST&&(a.taxationPIS=G(i)),s.CST&&(a.taxationCOFINS=V(s)),S.$emit("hideNextErrorMessage"),e.saveValiding(a).then(f,b)},d.showAliquotaGroup=function(e){return"CREDITO_101"===e.CSOSN||"CREDITO_COM_ST_201"===e.CSOSN||"OUTROS_900"===e.CSOSN},d.showIcmsStSimple=function(e){return"CREDITO_COM_ST_201"===e.CSOSN||"SEM_CREDITO_COM_ST_202"===e.CSOSN||"RECEITA_BRUTA_COM_ST_203"===e.CSOSN||"OUTROS_900"===e.CSOSN},d.showSimples=function(e){return"CREDITO_101"===e.CSOSN||"CREDITO_COM_ST_201"===e.CSOSN||"OUTROS_900"===e.CSOSN},d.showSimplesSt=function(e){return"CREDITO_COM_ST_201"===e.CSOSN||"SEM_CREDITO_COM_ST_202"===e.CSOSN||"RECEITA_BRUTA_COM_ST_203"===e.CSOSN||"ANTECIPACAO_ST_500"===e.CSOSN||"OUTROS_900"===e.CSOSN},d.isFCPVisible=function(e){return"IMUNE_300"!==e.CSOSN&&"NAO_TRIBUTADA_400"!==e.CSOSN&&"NAO_TRIBUTADA_41"!==e.CST&&"NAO_TRIBUTADA_41_ICMSST"!==e.CST}}]),angular.module("app.taxsettings.controllers").controller("TaxSettingsListController",["TaxationGroupService","$scope","gumgaController",function(e,a,t){t.createRestMethods(a,e,"taxationGroup"),a.content={},a.page=1,a.conf={columns:"tribute,titleParameterization,button",selection:"single",columnsConfig:[{name:"tribute",size:"col-md-3",title:'<strong gumga-translate-tag="taxsettings.tribute">Tribute</strong>',content:"<div>{{$value.taxationICMS?' ICMS':''}}{{$value.taxationIPI?' IPI':''}}{{$value.taxationPIS?' PIS':''}}{{$value.taxationCOFINS?' COFINS':''}}</div>"},{name:"titleParameterization",size:"col-md-8",title:'<strong gumga-translate-tag="taxsettings.titleparameterization">Title parameterization</strong>',content:"<div>{{$value.name}}</div>"},{name:"button",size:"col-md-1",title:" ",content:'<button type="button" ui-sref="taxsettings.edit({id: $value.id})" uib-tooltip="Editar" grands-button="edit-sm"></button>'}]},a.taxationGroup.execute("reset"),a.taxationGroup.execute("get"),a.taxationGroup.on("deleteSuccess",function(){a.taxationGroup.execute("get")})}]),angular.module("app.taxsettings",["ui.router","app.taxsettings.controllers","app.taxsettings.services","api.location"]).config(["$stateProvider","apiLocation",function(e,a){e.state("taxsettings.list",{url:"/list",templateUrl:"modules/taxsettings/views/list.html",controller:"TaxSettingsListController",data:{id:2}}).state("taxsettings.insert",{url:"/insert",templateUrl:"modules/taxsettings/views/form.html",controller:"TaxSettingsFormController",controllerAs:"form",data:{id:3},resolve:{entity:["$stateParams","$http",function(e,t){var i=a+"/api/taxationgroup/new";return t.get(i)}]}}).state("taxsettings.edit",{url:"/edit/:id",templateUrl:"modules/taxsettings/views/form.html",controller:"TaxSettingsFormController",data:{id:3},resolve:{entity:["$stateParams","$http",function(e,t){var i=a+"/api/taxationgroup/"+e.id;return t.get(i)}]}})}]),angular.module("taxsettings.core",["ui.router","ngSanitize","gumga.core","brasil.filters","ui.utils.masks","datePicker","app.stock","app.taxsettings","tributador.templates","buddy.core","operationtype.core","product.core"]).config(["$stateProvider",function(e){e.state("taxsettings",{data:{id:1},url:"/taxsettings",templateUrl:"base.html"})}]);