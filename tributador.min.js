angular.module("tributador.templates",[]).run(["$templateCache",function(a){a.put("baseTributador.html",'<div class="gumga-layout"><header class="gl-header" ng-controller="MenuController"><div class="searchbar"><div class="icon back"><button type="button" data-ng-click="toggleSearch()"><i class="material-icons">arrow_back</i></button></div><div class="query"><input type="text" class="form-control" placeholder="Pesquisar..."></div><div class="icon search"><button type="button"><i class="material-icons">search</i></button></div></div><nav class="navbar"><div class="container-fluid"><div class="navbar-header"><a class="navbar-brand" data-ng-click="navCollapse()"><i class="material-icons">menu</i></a><a class="navbar-brand" data-ng-click="navCollapse()"><img height="30" width="110" src="resources/images/mobi_logo_pq.png" alt=""></a><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false"><i class="material-icons">more_vert</i></button><button type="button" class="navbar-toggle" data-ng-click="toggleSearch()"><i class="material-icons">search</i></button></div><div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1"><ul class="nav navbar-nav organizations" title="Trocar de Organização"><li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><i class="material-icons">domain</i></a><ul class="dropdown-menu"><li><div class="form-group"><input type="text" class="form-control gmd" data-ng-model="org_search" placeholder="Pesquisar..."><div class="bar"></div></div></li><li data-ng-repeat="org in organizations | filter: org_search"><a href="" ng-click="changeOrganization(org)">{{org.name}}<span class="glyphicon glyphicon-ok" ng-show="org.name == user.organization || org.name == user.name"></span></a></li><li role="separator" class="divider"></li></ul></li></ul><form class="navbar-form navbar-left search hidden-sm hidden-xs"><div class="form-group"><div class="input-group"><span class="input-group-addon" id="basic-addon1"><i class="material-icons">search</i></span><input type="text" class="form-control" placeholder="Pesquisar..."></div></div></form><ul class="nav navbar-nav navbar-right"><li class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">{{user.name}}<span class="caret"></span></a><div class="dropdown-menu"><div class="row dropdown-account"><div class="col-xs-4"><img ng-src="{{user.profileImage}}" alt=""></div><div class="user-info"><b>{{user.name}}</b><span>{{user.login}}</span></div></div><hr style="margin-bottom: 10px"><div class="row"><div class="col-xs-12 dropdown-account-footer" style="padding:0 25px 10px 25px"><button ui-sref="user.profile" class="btn btn-primary raised gmd">Minha conta</button><div class="pull-right"><button type="button" ng-click="logout()" class="btn btn-default gmd" name="button">Sair</button></div></div></div></div></li></ul><ul class="nav navbar-nav navbar-right apps hidden-sm hidden-xs"><li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><i class="material-icons">apps</i></a><ul class="dropdown-menu" style="min-width: 95px !important"><li class="apps-icons"><table class="table"><tr><td><a ng-click="openFinance()"><img src="dist/grands/images/finance.png" alt=""><span class="text-bold text-uppercase">Financeiro</span></a></td></tr></table></li></ul></li></ul></div></div></nav></header><main ui-view style="background-color: #f5f5f5"></main><nav class="gl-nav" ng-controller="MenuController"><div class="navbar-header"><a class="navbar-brand" data-ng-click="navCollapse()"><i class="material-icons">menu</i></a><a class="navbar-brand" data-ng-click="navCollapse()"><img height="30" width="110" src="resources/images/mobi_logo_pq.png" alt=""></a></div><header><figure style="padding: 25% 3% 3% 3%"><img style="max-height: 200px" ng-src="{{companyLogo}}" alt=""></figure></header><div id="inputSearch"><input type="search" ng-model="menuSearch" class="form-control gmd"></div><gl-menu menu="menu" keys="keys" search="menuSearch"></gl-menu></nav></div>'),
a.put("modules/taxsettings/views/form.html",'<form name="forms" novalidate gumga-form><div class="row"><div class="col-lg-12"><div class="ibox float-e-margins"><div class="ibox-content"><div class="row"><div class="col-md-12"><label gumga-translate-tag="taxsettings.titleparameterization">Title parameterization</label><input type="text" class="form-control" ng-model="entity.name"></div></div></div></div><div class="ibox float-e-margins"><div class="ibox-content"><div class="row"><div class="col-md-2 b-r" ng-click="openPanel(\'tribute\')"><h5 gumga-translate-tag="taxsettings.tributeupper" align="center" class="b cursor-pointer">TRIBUTE</h5><h5 class="cursor-pointer" ng-repeat="obj in tribute track by $index">- {{obj}}</h5></div><div class="col-md-2 b-r" ng-click="openPanel(\'operation\')"><h5 gumga-translate-tag="taxsettings.operation" align="center" class="b cursor-pointer">OPERATION</h5><div class="list-5-scroll"><h5 ng-repeat="ot in entity.operationTypes track by $index" class="text-muted cursor-pointer">- {{ot.name}}</h5></div></div><div class="col-md-2 b-r" ng-click="openPanel(\'origin\')"><h5 gumga-translate-tag="taxsettings.origin" align="center" class="b cursor-pointer">ORIGIN</h5><div class="list-5-scroll"><h5 ng-repeat="or in entity.origins track by $index" class="text-muted cursor-pointer">- {{or.label}}</h5></div></div><div class="col-md-2 b-r" ng-click="openPanel(\'destination\')"><h5 gumga-translate-tag="taxsettings.destination" align="center" class="b cursor-pointer">DESTINATION</h5><div class="list-5-scroll"><h5 ng-repeat="des in entity.destinations track by $index" class="text-muted cursor-pointer">- {{des.label}}</h5></div></div><div class="col-md-2 b-r" ng-click="openPanel(\'person\')"><h5 gumga-translate-tag="taxsettings.person" align="center" class="b cursor-pointer">PERSON</h5><div class="list-5-scroll"><h5 ng-repeat="pg in entity.personGroups track by $index" class="text-muted cursor-pointer">- {{pg.name}}</h5></div></div><div class="col-md-2" ng-click="openPanel(\'product\')"><h5 gumga-translate-tag="taxsettings.product" align="center" class="b cursor-pointer">PRODUCT</h5><div class="list-5-scroll"><h5 ng-repeat="pg in entity.productGroups track by $index" class="text-muted cursor-pointer">- {{pg.name}}</h5></div></div></div></div></div><div class="ibox float-e-margins" ng-show="configOpen"><div class="ibox-content"><div class="row"><div ng-hide="step2"><div class="col-md-4 col-md-offset-1" align="center"><h4 gumga-translate-tag="taxsettings.operation" class="b">OPERATION</h4><div style="max-height: 282px; overflow-y: auto"><gumga-list data="operationTypesList" configuration="confOperation" class="table-bordered" selected-values="entity.operationTypes"></gumga-list></div></div><div class="col-md-4 col-md-offset-1" align="center"><h4 gumga-translate-tag="taxsettings.origin" class="b">ORIGIN</h4><div style="max-height: 282px; overflow-y: auto"><gumga-list data="stateOriginList" configuration="confState" class="table-bordered" selected-values="entity.origins"></gumga-list></div></div><div class="col-md-1 col-md-offset-1"><button type="button" class="btn-link center-block fa fa-chevron-right fa-3x" uib-tooltip="Próximo" style="margin-top: 140px" ng-click="step2 = true"></button></div></div><div ng-show="step2"><div class="col-md-1"><button type="button" class="btn-link center-block fa fa-chevron-left fa-3x" uib-tooltip="Anterior" style="margin-top: 140px" ng-click="step2 = false"></button></div><div class="col-md-3" align="center"><h4 gumga-translate-tag="taxsettings.destination" class="b">DESTINATION</h4><div style="max-height: 282px; overflow-y: auto"><gumga-list data="stateDestinationList" configuration="confState" class="table-bordered" selected-values="entity.destinations"></gumga-list></div></div><div class="col-md-3" align="center"><h4 gumga-translate-tag="taxsettings.person" class="b">PERSON</h4><div style="max-height: 282px; overflow-y: auto"><gumga-list data="personGroupList" configuration="confPerson" class="table-bordered" selected-values="entity.personGroups"></gumga-list></div></div><div class="col-md-4" align="center"><h4 gumga-translate-tag="taxsettings.product" class="b">PRODUCT</h4><div style="max-height: 282px; overflow-y: auto"><gumga-list data="productGroupList" configuration="confProduct" class="table-bordered" selected-values="entity.productGroups"></gumga-list></div></div><div class="col-md-1"><button type="button" class="btn btn-primary btn-circle btn-lg form-control" uib-tooltip="Tributar" style="margin-top: 140px" ng-click="openTaxation = true; configOpen = false;" ng-disabled="blockBtnTributos(entity)"><i class="fa fa-calculator fa-lg" style="margin-left: -3px"></i></button></div></div></div></div></div><div ng-if="openTaxation"><div class="ibox float-e-margins"><div align="center" class="ibox-title"><label class="btn-link ibox-title-label" ng-click="showICMS = !showICMS"><i ng-class="{\'fa fa-caret-down\' :showICMS, \'fa fa-caret-right\':!showICMS}"></i><span>PARÂMETROS DA TRIBUTAÇÃO DO ICMS</span></label></div><div class="ibox-content" ng-show="showICMS"><div class="row container-fluid"><div class="row m-t"><div class="col-md-4"><label>CFOP</label><gumga-many-to-one value="icms.cfop" search-method="getCfopIcms(param)" field="descricao" async display-info="false" editable="false"><match><div>{{match.model.codigo}}</div><div>{{match.model.descricao}}</div></match></gumga-many-to-one></div><div class="col-md-4" ng-show="icmsNormal"><label>CST</label><select name="icmsCst" id="icmsCst" ng-model="icms.CST" ng-options="cst.key as cst.label for cst in icmsTypes" class="form-control"></select></div><div class="col-md-4" ng-hide="icmsNormal"><label>CSOSN</label><select name="CSOSN" id="CSOSN" ng-model="icms.CSOSN" ng-options="cst.key as cst.label for cst in csosnTypes" class="form-control"></select></div><div class="col-md-4"><label>Mensagem</label><gumga-many-to-one value="icms.mensagem" search-method="getMensagem(param,\'ICMS\')" field="name" async display-info="false" editable="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div><div class="row m-t" ng-show="icmsNormal"><div class="col-md-6"><div ng-hide="isIcmsAble(icms)"><div class="row" align="center"><h4 class="b">ICMS</h4></div><div ng-show="isIcmsStandartGroupAble(icms)"><div class="row"><div class="col-md-7"><label>Modalidade Deter. da BC ICMS</label><select name="icmsModBC" id="icmsModBC" ng-model="icms.modBC" class="form-control" ng-options="mod.key as mod.label for mod in modeCalculationBaseList"></select></div><div class="col-md-5"><label>Fórmula Valor da BC ICMS</label><gumga-many-to-one value="icms.vBC" search-method="getFormulaIcms(param)" field="name" async display-info="false" editable="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div><div class="row m-t"><div class="col-md-5"><label>Alíquota ICMS</label><input type="text" class="form-control" ui-percentage-mask ng-model="icms.pICMS"></div><div class="col-md-7"><label>Fórmula Valor ICMS</label><gumga-many-to-one value="icms.vICMS" search-method="getFormulaIcms(param)" field="name" async display-info="false" editable="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div></div><div class="row" ng-show="isRedGroupAble(icms)"><div class="col-md-5 m-t container-fluid"><label>Redução da BC ICMS</label><input type="text" class="form-control" ng-model="icms.pRedBC" ui-percentage-mask></div><div class="col-md-7 m-t" ng-hide="!(icms.CST == \'COBRANCA_ST_10_COM_PARTILHA\' || icms.CST == \'OUTRAS_COM_PARTILHA_90\')"><label>BC da operação própria</label><input type="text" class="form-control" ng-model="icms.pBCOp" ui-percentage-mask></div></div><div ng-show="isIcmsDesoGroupAble(icms)"><div class="row"><div class="col-md-7 m-t"><label>Valor ICMS Desonerado</label><gumga-many-to-one value="icms.vICMSDeson" search-method="getFormulaIcms(param)" field="name" async display-info="false" editable="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div><div class="col-md-12 m-t"><div class="row"><label>Motivo da desoneração</label><select name="icmsMotDes" id="icmsMotDes" ng-model="icms.motDesICMS" class="form-control" ng-options="obj.key as obj.label for obj in unburdeningMotiveList"></select></div></div></div><div ng-show="icms.CST == \'DIFERIMENTO_51\'"><div class="row m-t"><div class="col-md-7"><label>ICMS da Operação</label><gumga-many-to-one value="icms.vICMSOp" search-method="getFormulaIcms(param)" field="name" async display-info="false" editable="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div><div class="col-md-5"><label>Percentual do Diferimento</label><input type="text" class="form-control" ui-percentage-mask ng-model="icms.pDif"></div></div><div class="row m-t"><div class="col-md-7"><label>Valor do ICMS diferido</label><gumga-many-to-one value="icms.vICMSDif" search-method="getFormulaIcms(param)" field="name" async display-info="false" editable="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div></div><div class="row m-t" ng-show="isFCPVisible(icms)"><div class="col-md-6"><label>Alíquota interna da UF de destino</label><input type="text" class="form-control" ui-percentage-mask ng-model="icms.pICMSUFDest"></div><div class="col-md-6"><label>Perc. Fundo Comb. à Pobreza</label><input type="text" class="form-control" ui-percentage-mask ng-model="icms.pFCPUFDest"></div></div></div></div><div class="col-md-6" ng-hide="isIcmsStAble(icms)"><div class="row" align="center"><h4 class="b">ICMS ST</h4></div><div ng-hide="isIcmsStStandartGroupAble(icms)"><div class="row"><div class="col-md-7"><label>Modalidade Deter. da BC ICMS ST</label><select name="icmsmodBCST" id="icmsBCST" ng-model="icms.modBCST" class="form-control" ng-options="modst.key as modst.label for modst in modeCalculationBaseSTList"></select></div><div class="col-md-5" ng-show="icms.CST == \'COBRANCA_ST_10\' || icms.CST == \'COBRANCA_ST_10_COM_PARTILHA\' || icms.CST == \'ISENTA_COM_ST_30\' || icms.CST == \'ST_REDUCAO_BC_70\' || icms.CST == \'OUTRAS_COM_PARTILHA_90\' || icms.CST == \'OUTROS_90\'"><label>Redução BC ICMS ST</label><input type="text" class="form-control" ui-percentage-mask ng-model="icms.pRedBCST"></div></div><div class="row m-t"><div class="col-md-5" ng-show="icms.CST == \'COBRANCA_ST_10\' || icms.CST == \'COBRANCA_ST_10_COM_PARTILHA\' || icms.CST == \'ISENTA_COM_ST_30\' || icms.CST == \'ST_REDUCAO_BC_70\' || icms.CST == \'OUTRAS_COM_PARTILHA_90\' || icms.CST == \'OUTROS_90\'"><label>Margem valor adic. ICMS ST</label><input type="text" class="form-control" ui-percentage-mask ng-model="icms.pMVAST"></div><div class="col-md-7" ng-show="icms.CST == \'COBRANCA_ST_10\' || icms.CST == \'COBRANCA_ST_10_COM_PARTILHA\' || icms.CST == \'ISENTA_COM_ST_30\' || icms.CST == \'ST_REDUCAO_BC_70\' || icms.CST == \'OUTRAS_COM_PARTILHA_90\' || icms.CST == \'OUTROS_90\'"><label>Fórmula Valor BC ICMS ST</label><gumga-many-to-one value="icms.vBCST" search-method="getFormulaIcms(param)" field="name" async display-info="false" editable="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div><div class="row m-t"><div class="col-md-5" ng-show="icms.CST == \'COBRANCA_ST_10\' || icms.CST == \'COBRANCA_ST_10_COM_PARTILHA\' || icms.CST == \'ISENTA_COM_ST_30\' || icms.CST == \'ST_REDUCAO_BC_70\' || icms.CST == \'OUTRAS_COM_PARTILHA_90\' || icms.CST == \'OUTROS_90\'"><label>Alíquota ICMS ST</label><input type="text" class="form-control" ui-percentage-mask ng-model="icms.pICMSST"></div><div class="col-md-7" ng-show="icms.CST == \'COBRANCA_ST_10\' || icms.CST == \'COBRANCA_ST_10_COM_PARTILHA\' || icms.CST == \'ISENTA_COM_ST_30\' || icms.CST == \'ST_REDUCAO_BC_70\' || icms.CST == \'OUTRAS_COM_PARTILHA_90\' || icms.CST == \'OUTROS_90\'"><label>Fórmula Valor ICMS ST</label><gumga-many-to-one value="icms.vICMSST" search-method="getFormulaIcms(param)" field="name" async display-info="false" editable="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div></div><div class="row m-t" ng-show="icms.CST == \'COBRANCA_ST_10_COM_PARTILHA\' || icms.CST == \'OUTRAS_COM_PARTILHA_90\'"><div class="col-md-6"><label>UF do ICMS ST devido na operação</label><select name="icmsuficmsdo" id="icmsuficmsdo" ng-model="icms.UFST" class="form-control" ng-options="obj.key as obj.label for obj in stateList"></select></div></div><div ng-show="icms.CST == \'ISENTA_COM_ST_30\'"><div class="row m-t"><div class="col-md-5"><label>Valor ICMS Desonerado</label><gumga-many-to-one value="icms.vICMSDeson" search-method="getFormulaIcms(param)" field="name" async display-info="false" editable="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div><div class="col-md-12 m-t"><div class="row"><label>Motivo da desoneração</label><select name="modIcmsSetDeson" id="modIcmsSetDeson" ng-model="icms.motDesICMS" class="form-control" ng-options="obj.key as obj.label for obj in unburdeningMotiveList"></select></div></div></div><div class="row" ng-show="icms.CST == \'NAO_TRIBUTADA_41_ICMSST\' || icms.CST == \'COBRADO_ANTERIORMENTE_POR_ST_60\'"><div class="col-md-6"><label ng-hide="icms.CST == \'COBRADO_ANTERIORMENTE_POR_ST_60\'">BC ICMS ST retido na UF remet.</label><label ng-show="icms.CST == \'COBRADO_ANTERIORMENTE_POR_ST_60\'">BC ICMS ST retido anteriormente</label><gumga-many-to-one value="icms.vBCSTRet" search-method="getFormulaIcms(param)" field="name" async display-info="false" editable="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div><div class="col-md-6"><label ng-hide="icms.CST == \'COBRADO_ANTERIORMENTE_POR_ST_60\'">ICMS ST retido na UF remet.</label><label ng-show="icms.CST == \'COBRADO_ANTERIORMENTE_POR_ST_60\'">ICMS ST retido anteriormente</label><gumga-many-to-one value="icms.vICMSSTRet" search-method="getFormulaIcms(param)" field="name" async display-info="false" editable="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div><div class="row"><div class="col-md-5" ng-show="icms.CST == \'COBRADO_ANTERIORMENTE_POR_ST_60\' ||icms.CST == \'ST_REDUCAO_BC_70\' || icms.CST == \'OUTRAS_COM_PARTILHA_90\' || icms.CST == \'OUTROS_90\'"><label>Redução ICMS ST Próprio</label><input type="text" class="form-control" ui-percentage-mask ng-model="icms.pRedIMCSSTProp"></div></div><div class="row m-t" ng-show="icms.CST == \'NAO_TRIBUTADA_41_ICMSST\'"><div class="col-md-6"><label>BC ICMS ST da UF destino</label><gumga-many-to-one value="icms.vBCSTDest" search-method="getFormulaIcms(param)" field="name" async display-info="false" editable="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div><div class="col-md-6"><label>ICMS ST da UF destino</label><gumga-many-to-one value="icms.vICMSSTDest" search-method="getFormulaIcms(param)" field="name" async display-info="false" editable="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div></div></div><div class="row m-t" ng-hide="icmsNormal"><div class="col-md-6"><div ng-show="showSimples(icms)"><div class="row" align="center"><h4 class="b">ICMS</h4></div><div ng-show="icms.CSOSN === \'OUTROS_900\'" class="m-b"><div class="row"><div class="col-md-7"><label>Modalidade Deter. da BC ICMS</label><select name="icmsModBC" ng-model="icms.modBC" class="form-control" ng-options="mod.key as mod.label for mod in modeCalculationBaseList"></select></div><div class="col-md-5"><label>Fórmula Valor da BC ICMS</label><gumga-many-to-one value="icms.vBC" search-method="getFormulaIcms(param)" field="name" async display-info="false" editable="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div><div class="row m-t"><div class="col-md-5"><label>Alíquota ICMS</label><input type="text" class="form-control" ui-percentage-mask ng-model="icms.pICMS"></div><div class="col-md-7"><label>Fórmula Valor ICMS</label><gumga-many-to-one value="icms.vICMS" search-method="getFormulaIcms(param)" field="name" async display-info="false" editable="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div><div class="row"><div class="col-md-5 m-t container-fluid"><label>Redução da BC ICMS</label><input type="text" class="form-control" ng-model="icms.pRedBC" ui-percentage-mask></div></div></div><div class="row" ng-if="showAliquotaGroup(icms)"><div class="col-md-7"><label>Alíquota aplicável de cálculo do crédito</label><input type="text" class="form-control" ui-percentage-mask ng-model="icms.pCredSN"></div><div class="col-md-5"><label>Fórmula Vl. crédito do ICMS</label><gumga-many-to-one value="icms.vCredICMSSN" search-method="getFormulaIcms(param)" field="name" async display-info="false" editable="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div><div class="row m-t" ng-show="isFCPVisible(icms)"><div class="col-md-6"><label>Alíquota interna da UF de destino</label><input type="text" class="form-control" ui-percentage-mask ng-model="icms.pICMSUFDest"></div><div class="col-md-6"><label>Perc. Fundo Comb. à Pobreza</label><input type="text" class="form-control" ui-percentage-mask ng-model="icms.pFCPUFDest"></div></div></div></div><div class="col-md-6" ng-show="showSimplesSt(icms)"><div class="row" align="center"><h4 class="b">ICMS ST</h4></div><div ng-show="showIcmsStSimple(icms)"><div class="row"><div class="col-md-7"><label>Modalidade Deter. da BC ICMS ST</label><select name="icmsmodBCST" ng-model="icms.modBCST" class="form-control" ng-options="modst.key as modst.label for modst in modeCalculationBaseSTList"></select></div><div class="col-md-5"><label>Redução BC ICMS ST</label><input type="text" class="form-control" ui-percentage-mask ng-model="icms.pRedBCST"></div></div><div class="row m-t"><div class="col-md-5" ng-if="icms.modBCST !== \'PAUTA\'"><label>Margem valor adic. ICMS ST</label><input type="text" class="form-control" ui-percentage-mask ng-model="icms.pMVAST"></div><div class="col-md-7 pull-right"><label>Fórmula Valor BC ICMS ST</label><gumga-many-to-one value="icms.vBCST" search-method="getFormulaIcms(param)" field="name" async display-info="false" editable="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div><div class="row m-t"><div class="col-md-5"><label>Alíquota ICMS ST</label><input type="text" class="form-control" ui-percentage-mask ng-model="icms.pICMSST"></div><div class="col-md-7"><label>Fórmula Valor ICMS ST</label><gumga-many-to-one value="icms.vICMSST" search-method="getFormulaIcms(param)" field="name" async display-info="false" editable="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div></div><div class="row" ng-show="icms.CSOSN === \'ANTECIPACAO_ST_500\'"><div class="col-md-6"><label>BC ICMS ST retido anteriormente</label><gumga-many-to-one value="icms.vBCSTRet" search-method="getFormulaIcms(param)" field="name" async display-info="false" editable="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div><div class="col-md-6"><label>ICMS ST retido anteriormente</label><gumga-many-to-one value="icms.vICMSSTRet" search-method="getFormulaIcms(param)" field="name" async display-info="false" editable="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div></div></div></div></div></div><div class="ibox float-e-margins"><div align="center" class="ibox-title"><label class="btn-link ibox-title-label" ng-click="showPIS = !showPIS"><i ng-class="{\'fa fa-caret-down\' :showPIS, \'fa fa-caret-right\':!showPIS}"></i><span>PARÂMETROS DA TRIBUTAÇÃO DO PIS</span></label></div><div class="ibox-content" ng-show="showPIS"><div class="row container-fluid"><div class="row"><div class="col-md-6"><label>CST</label><select name="cstpis" id="cstpis" ng-model="pis.CST" class="form-control" ng-options="obj.key as obj.label for obj in cstpis"></select></div><div class="col-md-6"><label>Mensagem</label><gumga-many-to-one value="pis.mensagem" search-method="getMensagem(param,\'PIS\')" field="name" async display-info="false" editable="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div><div class="row m-t" ng-hide="isPisAble(pis)"><div class="col-md-6"><div ng-hide="pis.CST == \'OPERACAO_TRIBUTAVEL_05\'"><div class="row"><h4 class="b" align="center">PIS</h4></div><div class="row"><div class="col-md-6" ng-hide="isPisOperationTypeUnable(pis)"><label>Tipo de cálculo</label><select name="calculationpis" id="calculationpis" ng-model="pis.calculationType" class="form-control" ng-options="obj for obj in calculationTypes"></select></div><div class="row" ng-show="isPisAliquotaAble(pis)"><div class="col-md-12"><div class="row"><div class="col-md-12"><div class="col-md-6"><label>Valor da base de cálculo</label><gumga-many-to-one value="pis.vBC" search-method="getFormulaPis(param)" field="name" async display-info="false" editable="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div><div class="col-md-6"><label>Alíquota (percentual)</label><input type="text" class="form-control" ui-percentage-mask ng-model="pis.pPIS"></div></div></div><div class="col-md-6 m-t"><label>Valor do PIS</label><gumga-many-to-one value="pis.vPIS" search-method="getFormulaPis(param)" field="name" async display-info="false" editable="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div></div></div></div></div><div class="col-md-6" ng-show="pis.CST === \'OPERACAO_TRIBUTAVEL_05\'"><div class="row"><h4 class="b" align="center">PIS ST</h4></div><div class="row"><div class="col-md-6"><label>Tipo de cálculo</label><select name="calculationpisst" id="calculationpisst" ng-model="pis.calculationTypeST" class="form-control" ng-options="obj for obj in calculationTypes"></select></div></div><div class="row" ng-show=" pis.calculationTypeST == \'PORCENTAGEM\'"><div class="row"><div class="col-md-12"><div class="col-md-6 m-t"><label>Valor da base de cálculo</label><gumga-many-to-one value="pis.vBCST" search-method="getFormulaPis(param)" field="name" async display-info="false" editable="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div><div class="col-md-6 m-t"><label>Alíquota (percentual)</label><input type="text" class="form-control" ui-percentage-mask ng-model="pis.pPISST"></div></div></div><div class="row"><div class="col-md-12"><div class="col-md-6 m-t"><label>Valor do PIS ST</label><gumga-many-to-one value="pis.vPISST" search-method="getFormulaPis(param)" field="name" async display-info="false" editable="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div></div></div></div></div></div></div></div><div class="ibox float-e-margins"><div align="center" class="ibox-title"><label class="btn-link ibox-title-label" ng-click="showCOFINS = !showCOFINS"><i ng-class="{\'fa fa-caret-down\':showCOFINS, \'fa fa-caret-right\':!showCOFINS}"></i><span>PARÂMETROS DA TRIBUTAÇÃO DO COFINS</span></label></div><div class="ibox-content" ng-show="showCOFINS"><div class="row container-fluid"><div class="row"><div class="col-md-6"><label>CST</label><select name="cstcofins" id="cstcofins" ng-model="cofins.CST" class="form-control" ng-options="obj.key as obj.label for obj in cstpis"></select></div><div class="col-md-6"><label>Mensagem</label><gumga-many-to-one value="cofins.mensagem" search-method="getMensagem(param,\'COFINS\')" field="name" async display-info="false" editable="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div><div class="row m-t" ng-hide="isCofinsAble(cofins)"><div class="col-md-6"><div ng-hide="cofins.CST == \'OPERACAO_TRIBUTAVEL_05\'"><div class="row"><h4 class="b" align="center">COFINS</h4></div><div class="row"><div class="col-md-6" ng-hide="isCofinsOperationTypeUnable(cofins)"><label>Tipo de cálculo</label><select name="calculationcofins" id="calculationcofins" ng-model="cofins.calculationType" class="form-control" ng-options="obj for obj in calculationTypes"></select></div><div class="row" ng-show="isCofinsAliquotaAble(cofins)"><div class="col-md-12"><div class="row"><div class="col-md-12"><div class="col-md-6 m-t"><label>Valor da base de cálculo</label><gumga-many-to-one value="cofins.vBC" search-method="getFormulaCofins(param)" field="name" async display-info="false" editable="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div><div class="col-md-6 m-t"><label>Alíquota (percentual)</label><input type="text" class="form-control" ui-percentage-mask ng-model="cofins.pCOFINS"></div></div></div><div class="col-md-6 m-t"><label>Valor do COFINS</label><gumga-many-to-one value="cofins.vCOFINS" search-method="getFormulaCofins(param)" field="name" async display-info="false" editable="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div></div></div></div></div><div class="col-md-6" ng-show="cofins.CST === \'OPERACAO_TRIBUTAVEL_05\'"><div class="row"><h4 class="b" align="center">COFINS ST</h4></div><div class="row"><div class="col-md-6"><label>Tipo de cálculo</label><select name="calculationcofinsst" id="calculationcofinsst" ng-model="cofins.calculationTypeST" class="form-control" ng-options="obj for obj in calculationTypes"></select></div></div><div ng-show="cofins.calculationTypeST == \'PORCENTAGEM\'"><div class="row"><div class="col-md-6 m-t"><label>Valor da base de cálculo</label><gumga-many-to-one value="cofins.vBCST" search-method="getFormulaCofins(param)" field="name" async display-info="false" editable="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div><div class="col-md-4 m-t"><label>Alíquota (percentual)</label><input type="text" class="form-control" ui-percentage-mask ng-model="cofins.pCOFINSST"></div></div><div class="row"><div class="col-md-6 m-t"><label>Valor do COFINS ST</label><gumga-many-to-one value="cofins.vCOFINSST" search-method="getFormulaCofins(param)" field="name" async display-info="false" editable="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div></div></div></div></div></div></div><div class="ibox float-e-margins"><div align="center" class="ibox-title"><label class="btn-link ibox-title-label" ng-click="showIPI = !showIPI"><i ng-class="{\'fa fa-caret-down\' :showIPI, \'fa fa-caret-right\':!showIPI }"></i><span>PARÂMETROS DA TRIBUTAÇÃO DO IPI</span></label></div><div class="ibox-content" ng-show="showIPI"><div class="row container-fluid"><div class="row"><div class="col-md-6"><label>CST</label><select name="cstipi" id="cstipi" ng-model="ipi.CST" class="form-control" ng-options="obj.key as obj.label for obj in cstipi"></select></div><div class="col-md-6"><label>Mensagem</label><gumga-many-to-one value="ipi.mensagem" search-method="getMensagem(param,\'IPI\')" field="name" async display-info="false" editable="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div><div class="row"><div class="col-md-6"><div class="row m-t" ng-hide="isIpiAble(ipi)"><div class="col-md-6"><label>Tipo de cálculo</label><select name="calculationipi" id="calculationipi" ng-model="ipi.ipiCalculationType" class="form-control" ng-options="obj for obj in calculationTypes"></select></div><div ng-show="ipi.ipiCalculationType == \'PORCENTAGEM\'"><div class="row"><div class="col-md-12"><div class="col-md-6 m-t"><label>Valor da base de cálculo</label><gumga-many-to-one value="ipi.vBC" search-method="getFormulaIpi(param)" field="name" async display-info="false" editable="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div><div class="col-md-6 m-t"><label>Alíquota</label><input type="text" class="form-control" ui-percentage-mask ng-model="ipi.pIPI"></div></div></div><div class="col-md-6 m-t"><label>Valor do IPI</label><gumga-many-to-one value="ipi.vIPI" search-method="getFormulaIpi(param)" field="name" async display-info="false" editable="false"><match><div>{{match.model.name}}</div></match></gumga-many-to-one></div></div></div></div></div></div></div></div></div></div></div><div class="pull-right"><button type="button" grands-button="return" ui-sref="taxsettings.list" ng-show="entity.id"></button><button type="button" grands-button="cancel" ui-sref="taxsettings.list" ng-hide="entity.id"></button><button type="button" grands-button="save" ng-click="update(entity,icms,pis,cofins,ipi)" ng-disabled="blockBtnTributos(entity) || saveDisabled(entity,icms,pis,cofins,ipi)"></button></div></form>'),a.put("modules/taxsettings/views/list.html",'<div class="row"><div class="col-lg-12"><div class="ibox float-e-margins"><div class="ibox-content"><div class="col-md-12"><div class="row"><div class="row"><div class="col-md-5"><button type="button" ui-sref="taxsettings.insert" grands-button="new"></button><button type="button" ng-click="taxationGroup.methods.delete(selectedValues)" grands-button="delete" ng-disabled="selectedValues.length == 0"></button></div><div class="col-md-7"><gumga-query search="taxationGroup.methods.search(field, param)" advanced-search="taxationGroup.methods.advancedSearch(param)"><search-field field="name" label="{{\'titleparameterization\'|gumgaTranslate:\'taxsettings\'}}" select="true"></search-field><advanced-search-field type="string" label="{{\'titleparameterization\'|gumgaTranslate:\'taxsettings\'}}" field="name"></advanced-search-field></gumga-query></div></div></div></div><div class="row"><div class="col-md-12" style="margin-top:1%"><gumga-list data="taxationGroup.data" configuration="conf" class="table-bordered"></gumga-list></div><div class="col-md-12"><ul uib-pagination ng-model="taxationGroup.page" items-per-page="taxationGroup.pageSize" total-items="taxationGroup.count" ng-change="taxationGroup.methods.get(taxationGroup.page)" previous-text="<< Anterior" next-text="Próximo >>" first-text="«" last-text="»"></ul></div></div></div></div></div></div>'),a.put("modules/taxsettings/views/modalConflito.html",'<div class="modal-header"><h3 class="modal-title" gumga-translate-tag="taxsettings.modaltitle"></h3></div><div class="modal-body"><p gumga-translate-tag="taxsettings.modaltext"></p><gumga-list data="values" configuration="conf" class="table-bordered"></gumga-list></div><div class="modal-footer"><button class="btn btn-warning" type="button" ng-click="close()" grands-button="close"></button></div>')}]),angular.module("app.taxsettings.services",["api.location"]),angular.module("app.taxsettings.services").service("FormulaService",["GumgaRest","apiLocation",function(a,e){return new a(e+"/api/formula")}]),angular.module("app.taxsettings.services").service("MensagemService",["GumgaRest","apiLocation",function(a,e){var t=new a(e+"/api/mensagem");return t.getAttributeMessageNames=function(){return this.extend("get","/attributemessagenames")},t}]),angular.module("app.taxsettings.services").service("TaxationGroupService",["GumgaRest","apiLocation",function(a,e){var t=new a(e+"/api/taxationgroup");return t.saveValiding=function(a){return a.id?this.extend("put","/validatesave",a):this.extend("post","/validatesave",a)},t.getStateList=function(){return this.extend("get","/state")},t.getICMSTypes=function(){return this.extend("get","/icmscst")},t.getCsosnTypes=function(){return this.extend("get","/csosntypes")},t.getIPITypes=function(){return this.extend("get","/ipicst")},t.getPISTypes=function(){return this.extend("get","/piscst")},t.getCalculationTypes=function(){return this.extend("get","/calculationtype")},t.getModeCalculationBaseTypes=function(){return this.extend("get","/modecalculationbase")},t.getModeCalculationBaseSTTypes=function(){return this.extend("get","/modecalculationbasest")},t.getUnburdeningMotives=function(){return this.extend("get","/unburdeningmotive")},t.getCofinsPisTypes=function(){return this.extend("get","/cofinscst")},t}]),angular.module("app.taxsettings.controllers",["app.taxsettings.services","ui.router"]),
angular.module("app.taxsettings.controllers").controller("ModalConflitoController",["entity","values","$scope","$uibModalInstance",function(a,e,t,i){function s(a,e){return a.filter(function(a){return e.filter(function(e){return e.id===a.id}).length>0})}function o(a,e){return a.filter(function(a){return e.filter(function(e){return e.key===a.key}).length>0})}a=angular.copy(a),t.values=angular.copy(e),t.values=t.values.map(function(e){return e.operationTypes=s(e.operationTypes,a.operationTypes),e.productTypes=s(e.productGroups,a.productGroups),e.personTypes=s(e.personGroups,a.personGroups),e.destinations=o(e.destinations,a.destinations),e.origins=o(e.origins,a.origins),e}),t.conf={columns:"id,name,operations,origins,destinations,personTypes,productType",selection:"none",columnsConfig:[{name:"id",size:"col-md-1",title:'<strong gumga-translate-tag="taxsettings.id">Code</strong>',content:"<div>{{$value.id}}</div>"},{name:"name",size:"col-md-1",title:'<strong gumga-translate-tag="taxsettings.name">Tribute</strong>',content:"<div>{{$value.name}}</div>"},{name:"operations",size:"col-md-2",title:'<strong gumga-translate-tag="taxsettings.operations">Operations</strong>',content:"<span ng-repeat=\"obj in $value.operationTypes track by $index\"> {{!$first?', ':''}}{{obj.name}}</span>"},{name:"origins",size:"col-md-2",title:'<strong gumga-translate-tag="taxsettings.origins">Origins</strong>',content:"<span ng-repeat=\"obj in $value.origins track by $index\"> {{!$first?', ':''}}{{obj.label}}</span>"},{name:"destinations",size:"col-md-2",title:'<strong gumga-translate-tag="taxsettings.destinations">Destinations</strong>',content:"<span ng-repeat=\"obj in $value.destinations track by $index\"> {{!$first?', ':''}}{{obj.label}}</span>"},{name:"personTypes",size:"col-md-2",title:'<strong gumga-translate-tag="taxsettings.groupofpeople">Group of People</strong>',content:"<span ng-repeat=\"obj in $value.personTypes track by $index\"> {{!$first?', ':''}}{{obj.name}}</span>"},{name:"productType",size:"col-md-2",title:'<strong gumga-translate-tag="taxsettings.productgroup">Product Group</strong>',content:"<span ng-repeat=\"obj in $value.productTypes track by $index\"> {{!$first?', ':''}}{{obj.name}}</span>"}]},t.close=function(){i.close(t.values)}}]),angular.module("app.taxsettings.controllers").controller("TaxSettingsFormController",["TaxationGroupService","MensagemService","JuridicaService","OperationTypeService","PersonGroupService","ProductGroupService","CfopService","FormulaService","$state","entity","$scope","$timeout","$uibModal","$rootScope","gumgaController",function(a,e,t,i,s,o,n,l,c,r,d,m,u,S,C){function v(a){if(a.CST)switch(a.CST){case"OPERACAO_TRIBUTAVEL_01":case"OPERACAO_TRIBUTAVEL_02":if(P(a))return!0;break;case"OPERACAO_TRIBUTAVEL_05":if(!a.calculationTypeST)return!0;if("PORCENTAGEM"===a.calculationTypeST&&M(a))return!0;break;case"OUTRAS_SAIDAS_49":case"OPERACOES_CREDITO_50":case"OPERACOES_CREDITO_51":case"OPERACOES_CREDITO_52":case"OPERACOES_CREDITO_53":case"OPERACOES_CREDITO_54":case"OPERACOES_CREDITO_55":case"OPERACOES_CREDITO_56":case"CREDITO_PRESUMIDO_60":case"CREDITO_PRESUMIDO_61":case"CREDITO_PRESUMIDO_62":case"CREDITO_PRESUMIDO_63":case"CREDITO_PRESUMIDO_64":case"CREDITO_PRESUMIDO_65":case"CREDITO_PRESUMIDO_66":case"CREDITO_PRESUMIDO_67":case"AQUISICAO_SEM_CREDITO_70":case"AQUISICAO_ISENTA_71":case"AQUISICAO_COM_SUSPENSAO_72":case"AQUISICAO_ALIQUOTA_ZERO_73":case"AQUISICAO_SEM_CONTRIBUICAO_74":case"AQUISICAO_ST_75":case"OUTRAS_ENTRADAS_98":case"OUTRAS_99":if(!a.calculationType)return!0;if("PORCENTAGEM"===a.calculationType&&P(a))return!0}}function T(a){if(a.CST)switch(a.CST){case"OPERACAO_TRIBUTAVEL_01":case"OPERACAO_TRIBUTAVEL_02":if(E(a))return!0;break;case"OPERACAO_TRIBUTAVEL_05":if(!a.calculationTypeST)return!0;if("PORCENTAGEM"===a.calculationTypeST&&h(a))return!0;break;case"OUTRAS_SAIDAS_49":case"OPERACOES_CREDITO_50":case"OPERACOES_CREDITO_51":case"OPERACOES_CREDITO_52":case"OPERACOES_CREDITO_53":case"OPERACOES_CREDITO_54":case"OPERACOES_CREDITO_55":case"OPERACOES_CREDITO_56":case"CREDITO_PRESUMIDO_60":case"CREDITO_PRESUMIDO_61":case"CREDITO_PRESUMIDO_62":case"CREDITO_PRESUMIDO_63":case"CREDITO_PRESUMIDO_64":case"CREDITO_PRESUMIDO_65":case"CREDITO_PRESUMIDO_66":case"CREDITO_PRESUMIDO_67":case"AQUISICAO_SEM_CREDITO_70":case"AQUISICAO_ISENTA_71":case"AQUISICAO_COM_SUSPENSAO_72":case"AQUISICAO_ALIQUOTA_ZERO_73":case"AQUISICAO_SEM_CONTRIBUICAO_74":case"AQUISICAO_ST_75":case"OUTRAS_ENTRADAS_98":case"OUTRAS_99":if(!a.calculationType)return!0;if("PORCENTAGEM"===a.calculationType&&E(a))return!0}}function g(a){if(a.CST)switch(a.CST){case"ENTRADA_RECUPERACAO_CREDITO_00":case"OUTRAS_ENTRADAS_49":case"SAIDA_TRIBUTADA_50":case"OUTRAS_SAIDAS_99":if(!a.ipiCalculationType||"PORCENTAGEM"===a.ipiCalculationType&&y(a))return!0}}function p(a){if(a.CST)switch(a.CST){case"INTEGRALMENTE_00":if(D(a))return!0;break;case"COBRANCA_ST_10":if(D(a)||N(a))return!0;break;case"OUTRAS_COM_PARTILHA_90":case"COBRANCA_ST_10_COM_PARTILHA":if(D(a)||N(a)||!a.UFST)return!0;break;case"REDUCAO_BC_20":if(D(a)||x(a))return!0;break;case"ISENTA_COM_ST_30":if(N(a)||x(a))return!0;break;case"ISENTA_40":case"NAO_TRIBUTADA_41":case"SUSPENSAO_50":if(x(a))return!0;break;case"NAO_TRIBUTADA_41_ICMSST":if(U(a))return!0;break;case"DIFERIMENTO_51":if(D(a)||B(a))return!0;break;case"COBRADO_ANTERIORMENTE_POR_ST_60":if(w(a))return!0;break;case"ST_REDUCAO_BC_70":case"OUTROS_90":if(D(a)||x(a)||N(a))return!0}}function _(a){if(a.CSOSN)switch(a.CSOSN){case"CREDITO_101":if(f(a))return!0;break;case"CREDITO_COM_ST_201":if(O(a)||f(a))return!0;break;case"SEM_CREDITO_COM_ST_202":case"RECEITA_BRUTA_COM_ST_203":if(O(a))return!0;break;case"ANTECIPACAO_ST_500":if(I(a))return!0;break;case"OUTROS_900":if(O(a)||f(a)||D(a))return!0}}function I(a){return a.vBCSTRet&&!a.vICMSSTRet||!a.vBCSTRet&&a.vICMSSTRet}function O(a){return!a.modBCST||!a.vBCST||null==a.pICMSST||!a.vICMSST}function f(a){return null==a.pCredSN||null==a.vCredICMSSN}function b(){c.go("taxsettings.list")}function A(a){var e=a.data.map(function(a){return a.destinations=R(a.destinations,d.stateDestinationList),a.origins=R(a.origins,d.stateOriginList),a});u.open({size:"lg",templateUrl:"modules/taxsettings/views/modalConflito.html",controller:"ModalConflitoController",resolve:{values:function(){return e},entity:function(){return d.entity}}})}function R(a,e){return a=a||[],a.map(function(a){return e.filter(function(e){return e.key===a})[0]})}function h(a){return!a.vBCST||null==a.pCOFINSST||!a.vCOFINSST}function E(a){return!a.vBC||null==a.pCOFINS||!a.vCOFINS}function y(a){return!a.vBC||null==a.pIPI||!a.vIPI}function M(a){return!a.vBCST||null==a.pPISST||!a.vPISST}function P(a){return!a.vBC||null==a.pPIS||!a.vPIS}function D(a){return!a.modBC||!a.vBC||null==a.pICMS||!a.vICMS}function x(a){return a.vICMSDeson&&!a.motDesICMS||!a.vICMSDeson&&a.motDesICMS}function N(a){return!(a.modBCST&&a.pRedBCST&&null!=a.pMVAST&&a.vBCST&&null!=a.pICMSST&&a.vICMSST)}function U(a){return!(a.vBCSTRet&&a.vICMSSTRet&&a.vBCSTDest&&a.vICMSSTDest)}function B(a){return!a.vICMSOp||null==a.pDif||!a.vICMSDif}function w(a){return!a.vBCSTRet||!a.vICMSSTRet}function k(a){return a.key}function F(a){var e={CST:a.CST,version:a.version,cfop:a.cfop,mensagem:a.mensagem};return"INTEGRALMENTE_00"!==a.CST&&"COBRANCA_ST_10"!==a.CST&&"OUTRAS_COM_PARTILHA_90"!==a.CST&&"COBRANCA_ST_10_COM_PARTILHA"!==a.CST&&"REDUCAO_BC_20"!==a.CST&&"DIFERIMENTO_51"!==a.CST&&"ST_REDUCAO_BC_70"!==a.CST&&"OUTROS_90"!==a.CST||(e.modBC=a.modBC,e.pICMS=a.pICMS,e.vBC=a.vBC,e.vICMS=a.vICMS),"COBRANCA_ST_10"!==a.CST&&"OUTRAS_COM_PARTILHA_90"!==a.CST&&"COBRANCA_ST_10_COM_PARTILHA"!==a.CST&&"ISENTA_COM_ST_30"!==a.CST&&"ST_REDUCAO_BC_70"!==a.CST&&"OUTROS_90"!==a.CST||(e.modBCST=a.modBCST,e.pICMSST=a.pICMSST,e.pMVAST=a.pMVAST,e.pRedBCST=a.pRedBCST,e.vBCST=a.vBCST,e.vICMSST=a.vICMSST),"OUTRAS_COM_PARTILHA_90"!==a.CST&&"COBRANCA_ST_10_COM_PARTILHA"!==a.CST||(e.UFST=a.UFST),"REDUCAO_BC_20"!==a.CST&&"ISENTA_COM_ST_30"!==a.CST&&"ISENTA_40"!==a.CST&&"NAO_TRIBUTADA_41"!==a.CST&&"SUSPENSAO_50"!==a.CST&&"ST_REDUCAO_BC_70"!==a.CST&&"OUTROS_90"!==a.CST||(e.vICMSDeson=a.vICMSDeson,e.motDesICMS=a.motDesICMS),"NAO_TRIBUTADA_41_ICMSST"===a.cst&&(e.vBCSTRet=a.vBCSTRet,e.vBCSTDest=a.vBCSTDest,e.vICMSSTDest=a.vICMSSTDest,e.vICMSSTRet=a.vICMSSTRet),"DIFERIMENTO_51"===a.cst&&(e.pDif=a.pDif,e.vICMSDif=a.vICMSDif,e.vICMSOp=a.vICMSOp),"COBRADO_ANTERIORMENTE_POR_ST_60"===a.cst&&(e.vBCSTRet=a.vBCSTRet,e.vICMSSTRet=a.vICMSSTRet),e}function L(a){var e={version:a.version,cfop:a.cfop,mensagem:a.mensagem,CSOSN:a.CSOSN};return"CREDITO_101"!==a.CSOSN&&"CREDITO_COM_ST_201"!==a.CSOSN&&"OUTROS_900"!==a.CSOSN||(e.pCredSN=a.pCredSN,e.vCredICMSSN=a.vCredICMSSN),"CREDITO_COM_ST_201"!==a.CSOSN&&"SEM_CREDITO_COM_ST_202"!==a.CSOSN&&"RECEITA_BRUTA_COM_ST_203"!==a.CSOSN&&"OUTROS_900"!==a.CSOSN||(e.modBCST=a.modBCST,e.pICMSST=a.pICMSST,e.pMVAST=a.pMVAST,e.pRedBCST=a.pRedBCST,e.vBCST=a.vBCST,e.vICMSST=a.vICMSST),"ANTECIPACAO_ST_500"===a.CSOSN&&(e.vBCSTRet=a.vBCSTRet,e.vICMSSTRet=a.vICMSSTRet),"OUTROS_900"===a.CSOSN&&(e.modBC=a.modBC,e.vBC=a.vBC,e.pRedBC=a.pRedBC,e.pICMS=a.pICMS,e.vICMS=a.vICMS),e}function G(a){var e={CST:a.CST,version:a.version,mensagem:a.mensagem};switch(a.CST){case"OPERACAO_TRIBUTAVEL_05":e.calculationTypeST=a.calculationTypeST,"PORCENTAGEM"===a.calculationTypeST&&(e.pPISST=a.pPISST,e.vBCST=a.vBCST,e.vPISST=a.vPISST);break;case"OPERACAO_TRIBUTAVEL_01":case"OPERACAO_TRIBUTAVEL_02":e.pPIS=a.pPIS,e.vBC=a.vBC,e.vPIS=a.vPIS;break;case"OUTRAS_SAIDAS_49":case"OPERACOES_CREDITO_50":case"OPERACOES_CREDITO_51":case"OPERACOES_CREDITO_52":case"OPERACOES_CREDITO_53":case"OPERACOES_CREDITO_54":case"OPERACOES_CREDITO_55":case"OPERACOES_CREDITO_56":case"CREDITO_PRESUMIDO_60":case"CREDITO_PRESUMIDO_61":case"CREDITO_PRESUMIDO_62":case"CREDITO_PRESUMIDO_63":case"CREDITO_PRESUMIDO_64":case"CREDITO_PRESUMIDO_65":case"CREDITO_PRESUMIDO_66":case"CREDITO_PRESUMIDO_67":case"AQUISICAO_SEM_CREDITO_70":case"AQUISICAO_ISENTA_71":case"AQUISICAO_COM_SUSPENSAO_72":case"AQUISICAO_ALIQUOTA_ZERO_73":case"AQUISICAO_SEM_CONTRIBUICAO_74":case"AQUISICAO_ST_75":case"OUTRAS_ENTRADAS_98":case"OUTRAS_99":e.calculationType=a.calculationType,"PORCENTAGEM"===a.calculationType&&(e.pPIS=a.pPIS,e.vBC=a.vBC,e.vPIS=a.vPIS)}return e}function V(a){var e={CST:a.CST,version:a.version,mensagem:a.mensagem};switch(a.CST){case"OPERACAO_TRIBUTAVEL_05":e.calculationTypeST=a.calculationTypeST,"PORCENTAGEM"===a.calculationTypeST&&(e.pCOFINSST=a.pCOFINSST,e.vBCST=a.vBCST,e.vCOFINSST=a.vCOFINSST);break;case"OPERACAO_TRIBUTAVEL_01":case"OPERACAO_TRIBUTAVEL_02":e.pCOFINS=a.pCOFINS,e.vBC=a.vBC,e.vCOFINS=a.vCOFINS;break;case"OUTRAS_SAIDAS_49":case"OPERACOES_CREDITO_50":case"OPERACOES_CREDITO_51":case"OPERACOES_CREDITO_52":case"OPERACOES_CREDITO_53":case"OPERACOES_CREDITO_54":case"OPERACOES_CREDITO_55":case"OPERACOES_CREDITO_56":case"CREDITO_PRESUMIDO_60":case"CREDITO_PRESUMIDO_61":case"CREDITO_PRESUMIDO_62":case"CREDITO_PRESUMIDO_63":case"CREDITO_PRESUMIDO_64":case"CREDITO_PRESUMIDO_65":case"CREDITO_PRESUMIDO_66":case"CREDITO_PRESUMIDO_67":case"AQUISICAO_SEM_CREDITO_70":case"AQUISICAO_ISENTA_71":case"AQUISICAO_COM_SUSPENSAO_72":case"AQUISICAO_ALIQUOTA_ZERO_73":case"AQUISICAO_SEM_CONTRIBUICAO_74":case"AQUISICAO_ST_75":case"OUTRAS_ENTRADAS_98":case"OUTRAS_99":e.calculationType=a.calculationType,"PORCENTAGEM"===a.calculationType&&(e.pCOFINS=a.pCOFINS,e.vBC=a.vBC,e.vCOFINS=a.vCOFINS)}return e}function j(a){var e={CST:a.CST,version:a.version,mensagem:a.mensagem};switch(a.CST){case"ENTRADA_RECUPERACAO_CREDITO_00":case"OUTRAS_ENTRADAS_49":case"SAIDA_TRIBUTADA_50":case"OUTRAS_SAIDAS_99":e.ipiCalculationType=a.ipiCalculationType,"PORCENTAGEM"===a.ipiCalculationType&&(e.pIPI=a.pIPI,e.vBC=a.vBC,e.vIPI=a.vIPI)}return e}function $(a){return{"2px solid red":function(){return d.operationConflicts.filter(function(e){return e.id===a.id}).length>0}}}C.createRestMethods(d,a,"taxationGroup"),d.taxationGroup.execute("reset"),d.entity=angular.copy(r.data),d.pis=d.entity.taxationPIS||{},d.icms=d.entity.taxationICMS||{},d.cofins=d.entity.taxationCOFINS||{},d.ipi=d.entity.taxationIPI||{},d.continue={},d.entity.operationTypes=d.entity.operationTypes||[],d.entity.origins=d.entity.origins||[],d.entity.destinations=d.entity.destinations||[],d.entity.personGroups=d.entity.personGroups||[],d.entity.productGroups=d.entity.productGroups||[],d.vICMSd=d.vICMSd||0,d.showICMS=!1,d.showPIS=!1,d.showCOFINS=!1,d.openTaxation=!1,d.step1=!1,d.configOpen=!1,d.mensagemICMSList=[],d.mensagemPISList=[],d.mensagemIPIList=[],d.mensagemCOFINSList=[],d.formulaIcmsBCList=[],d.formulaValorIcms=[],d.formulaBaseIcmsSt=[],d.formulaValorIcmsSt=[],d.formulaValorIcmsDeson=[],d.formulaIcmsStDeson=[],d.fomulasBaseIcmsRet=[],d.formulaValorIcmsRet=[],d.formulaBaseIcmsDest=[],d.formulaValorIcmsDest=[],d.formulaValorIcmsOpe=[],d.formulaBasePis=[],d.formulaBasePisST=[],d.formulaValorPisST=[],d.formulaValorPis=[],d.formulaBaseCofins=[],d.formulaBaseCofinsST=[],d.formulaValorCofinsST=[],d.formulaValorCofins=[],d.cfopList=[],d.stateOriginConflicts=[],d.stateDestinationsConflicts=[],d.personGroupConflicts=[],d.productGroupConflicts=[],d.operationConflicts=[],d.entity.id&&(d.openTaxation=!0,d.configOpen=!1),t.getCurrentCompany().then(function(a){d.icmsNormal="REGIME_NORMAL"===a.data.crt,d.icmsNormal?d.tribute=["ICMS","PIS","COFINS","IPI"]:(d.tribute=["ICMS Simples","PIS","COFINS","IPI"],d.icms.CST="")}),i.all().then(function(a){d.operationTypesList=a.data.values,m(function(){d.entity.operationTypes=r.data.operationTypes||[],d.entity.operationTypes=d.entity.operationTypes.map(function(a){return d.operationTypesList.filter(function(e){return e.id===a.id})[0]})})}),s.all().then(function(a){d.personGroupList=a.data.values,m(function(){d.entity.personGroups=r.data.personGroups||[]})}),o.all().then(function(a){d.productGroupList=a.data.values,m(function(){d.entity.productGroups=r.data.productGroups||[]})}),a.getStateList().then(function(a){d.stateDestinationList=d.stateOriginList=a.data,m(function(){d.entity.origins=R(r.data.origins,d.stateOriginList),d.entity.destinations=R(r.data.destinations,d.stateDestinationList)})}),a.getICMSTypes().then(function(a){d.icmsTypes=[{label:" "}].concat(a.data)}),a.getCsosnTypes().then(function(a){d.csosnTypes=[{label:" "}].concat(a.data)}),a.getPISTypes().then(function(a){d.cstpis=[{label:" "}].concat(a.data)}),a.getIPITypes().then(function(a){d.cstipi=[{label:" "}].concat(a.data)}),a.getCalculationTypes().then(function(a){d.calculationTypes=a.data}),a.getModeCalculationBaseTypes().then(function(a){d.modeCalculationBaseList=[{label:" "}].concat(a.data)}),a.getModeCalculationBaseSTTypes().then(function(a){d.modeCalculationBaseSTList=[{label:" "}].concat(a.data)}),a.getUnburdeningMotives().then(function(a){d.unburdeningMotiveList=[{label:" "}].concat(a.data)}),d.confOperation={columns:"operations",selection:"multi",conditional:$,checkbox:!0,columnsConfig:[{name:"operations",size:"col-md-9",title:'<strong gumga-translate-tag="taxsettings.operations">Operations</strong>',content:"<div>{{$value.name}}</div>"}]},d.confState={columns:"state",selection:"multi",checkbox:!0,columnsConfig:[{name:"state",size:"col-md-9",title:'<strong gumga-translate-tag="taxsettings.state">State</strong>',content:"<div>{{$value.label}}</div>"}]},d.confPerson={columns:"person",selection:"multi",checkbox:!0,columnsConfig:[{name:"person",size:"col-md-9",title:'<strong gumga-translate-tag="taxsettings.groupofpeople">Group of People</strong>',content:"<div>{{$value.name}}</div>"}]},d.confProduct={columns:"product",selection:"multi",checkbox:!0,columnsConfig:[{name:"product",size:"col-md-9",title:'<strong gumga-translate-tag="taxsettings.productgroup">Product Group</strong>',content:"<div>{{$value.name}}</div>"}]},d.openPanel=function(a){"tribute"===a||"operation"===a||"origin"===a?(d.configOpen=!0,d.openTaxation=!1,d.step2=!1):(d.configOpen=!0,d.openTaxation=!1,d.step2=!0)},d.entity.id||d.openPanel("tribute"),d.blockBtnTributos=function(a){return 0===a.operationTypes.length||0===a.origins.length||0===a.destinations.length||0===a.personGroups.length||0===a.productGroups.length},d.isIcmsAble=function(a){return!a.CST||"ISENTA_COM_ST_30"===a.CST||"NAO_TRIBUTADA_41_ICMSST"===a.CST||"COBRADO_ANTERIORMENTE_POR_ST_60"===a.CST},d.isIcmsStandartGroupAble=function(a){return"INTEGRALMENTE_00"===a.CST||"COBRANCA_ST_10"===a.CST||"COBRANCA_ST_10_COM_PARTILHA"===a.CST||"REDUCAO_BC_20"===a.CST||"DIFERIMENTO_51"===a.CST||"ST_REDUCAO_BC_70"===a.CST||"OUTRAS_COM_PARTILHA_90"===a.CST||"OUTROS_90"===a.CST},d.isIcmsDesoGroupAble=function(a){return"REDUCAO_BC_20"===a.CST||"ISENTA_40"===a.CST||"NAO_TRIBUTADA_41"===a.CST||"SUSPENSAO_50"===a.CST||"ST_REDUCAO_BC_70"===a.CST||"OUTROS_90"===a.CST},d.isIcmsRedGroupAble=function(a){return"COBRANCA_ST_10_COM_PARTILHA"===a.CST||"REDUCAO_BC_20"===a.CST||"DIFERIMENTO_51"===a.CST||"ST_REDUCAO_BC_70"===a.CST||"OUTRAS_COM_PARTILHA_90"===a.CST||"OUTROS_90"===a.CST},d.isIcmsStAble=function(a){return!a.CST||"INTEGRALMENTE_00"===a.CST||"REDUCAO_BC_20"===a.CST||"ISENTA_40"===a.CST||"NAO_TRIBUTADA_41"===a.CST||"SUSPENSAO_50"===a.CST||"DIFERIMENTO_51"===a.CST},d.isIcmsStStandartGroupAble=function(a){return"NAO_TRIBUTADA_41_ICMSST"===a.CST||"COBRADO_ANTERIORMENTE_POR_ST_60"===a.CST},d.getCfopIcms=function(a){return a=a||"",n.getAdvancedSearch("lower(obj.codigo) like lower('%"+a+"%') or lower(obj.descricao) like lower('%"+a+"%')").then(function(a){return a.data.values})},d.getFormulaIcms=function(a){return l.getAdvancedSearch("lower(obj.name) like lower('%"+a+"%') and obj.tariffType = br.com.codein.tributador.domain.model.tributador.enums.TariffType.ICMS").then(function(a){return a.data.values})},d.getFormulaPis=function(a){return l.getAdvancedSearch("lower(obj.name) like lower('%"+a+"%') and obj.tariffType = br.com.codein.tributador.domain.model.tributador.enums.TariffType.PIS").then(function(a){return a.data.values})},d.getFormulaCofins=function(a){return l.getAdvancedSearch("lower(obj.name) like lower('%"+a+"%') and obj.tariffType = br.com.codein.tributador.domain.model.tributador.enums.TariffType.COFINS").then(function(a){return a.data.values})},d.getFormulaIpi=function(a){return l.getAdvancedSearch("lower(obj.name) like lower('%"+a+"%') and obj.tariffType = br.com.codein.tributador.domain.model.tributador.enums.TariffType.IPI").then(function(a){return a.data.values})},d.getMensagem=function(a,t){return e.getAdvancedSearch("lower(obj.name) like lower('%"+a+"%') and obj.tariffType = br.com.codein.tributador.domain.model.tributador.enums.TariffType."+t).then(function(a){return a.data.values})},d.isIpiAble=function(a){return!a.CST||"ENTRADA_RECUPERACAO_CREDITO_00"!==a.CST&&"OUTRAS_ENTRADAS_49"!==a.CST&&"SAIDA_TRIBUTADA_50"!==a.CST&&"OUTRAS_SAIDAS_99"!==a.CST},d.isPisAble=function(a){return!a.CST||"OPERACAO_TRIBUTAVEL_04"===a.CST||"OPERACAO_TRIBUTAVEL_03"===a.CST||"OPERACAO_TRIBUTAVEL_06"===a.CST||"OPERACAO_TRIBUTAVEL_07"===a.CST||"SEM_INCIDENCIA_08"===a.CST||"COM_SUSPENSAO_09"===a.CST},d.isPisOperationTypeUnable=function(a){return a.CST&&(d.isPisAble(a)||"OPERACAO_TRIBUTAVEL_01"===a.CST||"OPERACAO_TRIBUTAVEL_02"===a.CST)},d.isPisAliquotaAble=function(a){return d.isPisOperationTypeUnable(a)||"PORCENTAGEM"===a.calculationType},d.isCofinsAble=function(a){return!a.CST||"OPERACAO_TRIBUTAVEL_04"===a.CST||"OPERACAO_TRIBUTAVEL_03"===a.CST||"OPERACAO_TRIBUTAVEL_06"===a.CST||"OPERACAO_TRIBUTAVEL_07"===a.CST||"SEM_INCIDENCIA_08"===a.CST||"COM_SUSPENSAO_09"===a.CST},d.isCofinsOperationTypeUnable=function(a){return a.CST&&(d.isCofinsAble(a)||"OPERACAO_TRIBUTAVEL_01"===a.CST||"OPERACAO_TRIBUTAVEL_02"===a.CST)},d.isCofinsAliquotaAble=function(a){return d.isCofinsOperationTypeUnable(a)||"PORCENTAGEM"===a.calculationType},d.saveDisabled=function(a,e,t,i,s){return d.icmsNormal&&p(e)||!d.icmsNormal&&_(e)||v(t)||T(i)||g(s)},d.update=function(e,t,i,s,o){e.destinations=e.destinations.map(k),e.origins=e.origins.map(k),delete e.taxationIPI,delete e.taxationPIS,delete e.taxationCOFINS,delete e.taxationICMS,o=angular.copy(o),t=angular.copy(t),i=angular.copy(i),s=angular.copy(s),o.CST&&(e.taxationIPI=j(o)),d.icmsNormal&&t.CST?e.taxationICMS=F(t):!d.icmsNormal&&t.CSOSN&&(e.taxationICMS=L(t)),e.taxationICMS&&d.isFCPVisible(e.taxationICMS)&&(e.taxationICMS.pICMSUFDest=t.pICMSUFDest,e.taxationICMS.pFCPUFDest=t.pFCPUFDest),i.CST&&(e.taxationPIS=G(i)),s.CST&&(e.taxationCOFINS=V(s)),S.$emit("hideNextErrorMessage"),a.saveValiding(e).then(b,A)},d.showAliquotaGroup=function(a){return"CREDITO_101"===a.CSOSN||"CREDITO_COM_ST_201"===a.CSOSN||"OUTROS_900"===a.CSOSN},d.showIcmsStSimple=function(a){return"CREDITO_COM_ST_201"===a.CSOSN||"SEM_CREDITO_COM_ST_202"===a.CSOSN||"RECEITA_BRUTA_COM_ST_203"===a.CSOSN||"OUTROS_900"===a.CSOSN},d.showSimples=function(a){return"CREDITO_101"===a.CSOSN||"CREDITO_COM_ST_201"===a.CSOSN||"OUTROS_900"===a.CSOSN},d.showSimplesSt=function(a){return"CREDITO_COM_ST_201"===a.CSOSN||"SEM_CREDITO_COM_ST_202"===a.CSOSN||"RECEITA_BRUTA_COM_ST_203"===a.CSOSN||"ANTECIPACAO_ST_500"===a.CSOSN||"OUTROS_900"===a.CSOSN},d.isFCPVisible=function(a){return"IMUNE_300"!==a.CSOSN&&"NAO_TRIBUTADA_400"!==a.CSOSN&&"NAO_TRIBUTADA_41"!==a.CST&&"NAO_TRIBUTADA_41_ICMSST"!==a.CST}}]),angular.module("app.taxsettings.controllers").controller("TaxSettingsListController",["TaxationGroupService","$scope","gumgaController",function(a,e,t){t.createRestMethods(e,a,"taxationGroup"),e.content={},e.page=1,e.conf={columns:"tribute,titleParameterization,button",selection:"single",columnsConfig:[{name:"tribute",size:"col-md-3",title:'<strong gumga-translate-tag="taxsettings.tribute">Tribute</strong>',content:"<div>{{$value.taxationICMS?' ICMS':''}}{{$value.taxationIPI?' IPI':''}}{{$value.taxationPIS?' PIS':''}}{{$value.taxationCOFINS?' COFINS':''}}</div>"},{name:"titleParameterization",size:"col-md-8",title:'<strong gumga-translate-tag="taxsettings.titleparameterization">Title parameterization</strong>',content:"<div>{{$value.name}}</div>"},{name:"button",size:"col-md-1",title:" ",content:'<button type="button" ui-sref="taxsettings.edit({id: $value.id})" uib-tooltip="Editar" grands-button="edit-sm"></button>'}]},e.taxationGroup.execute("reset"),e.taxationGroup.execute("get"),e.taxationGroup.on("deleteSuccess",function(){e.taxationGroup.execute("get")})}]),angular.module("app.taxsettings",["ui.router","app.taxsettings.controllers","app.taxsettings.services","api.location"]).config(["$stateProvider","apiLocation",function(a,e){a.state("taxsettings.list",{url:"/list",templateUrl:"modules/taxsettings/views/list.html",controller:"TaxSettingsListController",data:{id:2}}).state("taxsettings.insert",{url:"/insert",templateUrl:"modules/taxsettings/views/form.html",controller:"TaxSettingsFormController",controllerAs:"form",data:{id:3},resolve:{entity:["$stateParams","$http",function(a,t){var i=e+"/api/taxationgroup/new";return t.get(i)}]}}).state("taxsettings.edit",{url:"/edit/:id",templateUrl:"modules/taxsettings/views/form.html",controller:"TaxSettingsFormController",data:{id:3},resolve:{entity:["$stateParams","$http",function(a,t){var i=e+"/api/taxationgroup/"+a.id;return t.get(i)}]}})}]),angular.module("taxsettings.core",["ui.router","ngSanitize","gumga.core","brasil.filters","ui.utils.masks","datePicker","app.stock","app.taxsettings","tributador.templates","buddy.core","operationtype.core","product.core"]).config(["$stateProvider",function(a){a.state("taxsettings",{data:{id:1},url:"/taxsettings",templateUrl:"baseTributador.html"})}]);